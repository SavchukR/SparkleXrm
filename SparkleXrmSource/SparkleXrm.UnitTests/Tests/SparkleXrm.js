// SparkleXrm.js
var scriptLoader=scriptLoader||{delayedLoads:[],load:function(name,requires,script){window._loadedScripts=window._loadedScripts||{};if(requires==null||requires.length==0||scriptLoader.areLoaded(requires)){scriptLoader.runScript(name,script);} else{scriptLoader.delayedLoads.push({name:name,requires:requires,script:script});}},runScript:function(name,script){script.call(window);window._loadedScripts[name]=true;scriptLoader.onScriptLoaded(name);},onScriptLoaded:function(name){scriptLoader.delayedLoads.forEach(function(script){if(script.loaded==null&&scriptLoader.areLoaded(script.requires)){script.loaded=true;scriptLoader.runScript(script.name,script.script);}});},areLoaded:function(requires){var allLoaded=true;for(var i=0;i<requires.length;i++){var isLoaded=(window._loadedScripts[requires[i]]!=null);allLoaded=allLoaded&&isLoaded;if(!allLoaded)break;} return allLoaded;}};scriptLoader.load("xrm",["mscorlib"],function(){
Type.registerNamespace('SparkleXrm');Type.registerNamespace('SparkleXrm.Xrm');Type.registerNamespace('Xrm');SparkleXrm.ArrayEx=function(){}
SparkleXrm.ArrayEx.add=function(list,item){list[list.length]=item;}
SparkleXrm.ArrayEx.getEnumerator=function(list){return new ss.ArrayEnumerator(list);}
SparkleXrm.ArrayEx.join=function(list,delimeter){var $0='';for(var $1=0;$1<list.length;$1++){if($1>0){$0+=delimeter;}$0+=list[$1];}return $0;}
SparkleXrm.DelegateItterator=function(){}
SparkleXrm.DelegateItterator.callbackItterate=function(action,numberOfTimes,completeCallBack,errorCallBack){SparkleXrm.DelegateItterator.$0(action,0,numberOfTimes,completeCallBack,errorCallBack);}
SparkleXrm.DelegateItterator.$0=function($p0,$p1,$p2,$p3,$p4){if($p1<$p2){try{$p0($p1,function(){
$p1++;SparkleXrm.DelegateItterator.$0($p0,$p1,$p2,$p3,$p4);},function($p1_0){
$p4($p1_0);});}catch($0){$p4($0);}}else{$p3();}}
SparkleXrm.NumberEx=function(){}
SparkleXrm.NumberEx.parse=function(value,format){if(String.isNullOrEmpty(value)){return null;}value=value.replaceAll(' ','');value=value.replaceAll(format.numberSepartor,'');if(format.decimalSymbol!=='.'){value=value.replaceAll(format.decimalSymbol,'.');}if(value.startsWith('(')){value='-'+value.replaceAll('(','').replaceAll(')','');}else if(value.endsWith('-')){value='-'+value.substring(0,value.length-1);}var $0=Number.parse(value);return $0;}
SparkleXrm.NumberEx.getNumberFormatInfo=function(){var $0={};if(SparkleXrm.Sdk.OrganizationServiceProxy.userSettings!=null){$0.decimalSymbol=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.decimalsymbol;$0.numberGroupFormat=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numbergroupformat;$0.numberSepartor=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numberseparator;$0.negativeFormatCode=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.negativeformatcode;}else{$0.decimalSymbol='.';$0.numberGroupFormat='3';$0.numberSepartor=',';$0.negativeFormatCode=0;}$0.precision=2;$0.minValue=-2147483648;$0.maxValue=2147483648;return $0;}
SparkleXrm.NumberEx.getCurrencyEditFormatInfo=function(){var $0={};if(SparkleXrm.Sdk.OrganizationServiceProxy.userSettings!=null){$0.decimalSymbol=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.decimalsymbol;$0.numberGroupFormat=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numbergroupformat;$0.numberSepartor=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numberseparator;$0.negativeFormatCode=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.negativecurrencyformatcode;$0.precision=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.currencydecimalprecision;$0.currencySymbol=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.currencysymbol;}else{$0.decimalSymbol='.';$0.numberGroupFormat='3';$0.numberSepartor=',';$0.negativeFormatCode=0;$0.precision=2;$0.currencySymbol='$';}return $0;}
SparkleXrm.NumberEx.getCurrencyFormatInfo=function(){var $0={};if(SparkleXrm.Sdk.OrganizationServiceProxy.userSettings!=null){$0.decimalSymbol=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.decimalsymbol;$0.numberGroupFormat=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numbergroupformat;$0.numberSepartor=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numberseparator;$0.negativeFormatCode=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.negativecurrencyformatcode;$0.precision=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.currencydecimalprecision;$0.currencySymbol=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.currencysymbol;}else{$0.decimalSymbol='.';$0.numberGroupFormat='3';$0.numberSepartor=',';$0.negativeFormatCode=0;$0.precision=2;$0.currencySymbol='$';}return $0;}
SparkleXrm.NumberEx.format=function(actualValue,format){if(actualValue==null){return '';}var $0=actualValue;var $1=format.numberGroupFormat.split(',');var $2='';if(format.precision!=null){$0.toFixed(format.precision);}var $3=Math.floor(Math.abs($0));var $4=$3.toString();var $5=$0.toString().substr($4.length+1+(($0<0)?1:0));var $6=$4.length;var $7=0;while($6>0){var $9=parseInt($1[$7]);if($7<($1.length-1)){$7++;}if(!$9){$9=$6+1;}$2=$4.substring($6,$6-$9)+$2;if($6>$9){$2=format.numberSepartor+$2;}$6=$6-$9;}var $8=($0<0);if(format.precision>0){var $A=format.precision-$5.length;for(var $B=0;$B<$A;$B++){$5=$5+'0';}$2=$2+format.decimalSymbol+$5;}if($8){switch(format.negativeFormatCode){case 0:$2='('+$2+')';break;case 2:$2='- '+$2;break;case 3:$2=$2+'-';break;case 4:$2=$2+' -';break;case 1:default:$2='-'+$2;break;}}return $2;}
SparkleXrm.NumberEx.round=function(numericValue,precision){var $0=1;if(precision>0){$0=Math.pow(10,precision);}return Math.round(numericValue*$0)/$0;}
SparkleXrm.NumberEx.getCurrencySymbol=function(currencyId){var $0=SparkleXrm.Services.CachedOrganizationService.retrieveMultiple("<fetch distinct='false' no-lock='false' mapping='logical'><entity name='organization'><attribute name='currencydisplayoption' /><attribute name='currencysymbol' /></entity></fetch>");var $1=$0.entities.get_item(0);var $2=SparkleXrm.Services.CachedOrganizationService.retrieve('transactioncurrency',currencyId.toString(),['currencysymbol','isocurrencycode']);if(!$1.getAttributeValueOptionSet('currencydisplayoption').value){return $2.getAttributeValueString('currencysymbol')+' ';}else{return $2.getAttributeValueString('isocurrencycode')+' ';}}
SparkleXrm.Xrm.PageEx=function(){}
SparkleXrm.Xrm.PageEx.getCacheKey=function(){var $0=window.WEB_RESOURCE_ORG_VERSION_NUMBER;if(!ss.isNullOrUndefined($0)){return $0+'/';}var $1=new RegExp('%7b[0-9]*%7d(?=\\/webresources)','g');var $2=$1.exec(window.location.href);if($2!=null&&$2.length>0){return $2[0]+'/';}return '';}
SparkleXrm.Xrm.PageEx.getWebResourceData=function(){var $0=window.location.search;if($0!=null&&!!$0){var $1=$0.substr(1).split('&');var $enum1=ss.IEnumerator.getEnumerator($1);while($enum1.moveNext()){var $2=$enum1.current;if($2.toLowerCase().startsWith('data=')){var $3=$2.replaceAll('+',' ').split('=');return SparkleXrm.Xrm.PageEx.$0($3[1]);}}}return {};}
SparkleXrm.Xrm.PageEx.$0=function($p0){var $0={};var $1=(decodeURIComponent($p0)).split('&');var $enum1=ss.IEnumerator.getEnumerator($1);while($enum1.moveNext()){var $2=$enum1.current;var $3=$2.split('=');$0[$3[0]]=$3[1];}return $0;}
SparkleXrm.StringEx=function(){}
SparkleXrm.StringEx.IN=function(value,values){if(value!=null){var $enum1=ss.IEnumerator.getEnumerator(values);while($enum1.moveNext()){var $0=$enum1.current;if(value===$0){return true;}}}return false;}
SparkleXrm.TaskIterrator=function(){this.$0=[];}
SparkleXrm.TaskIterrator.prototype={$1:null,$2:null,addTask:function(task,state){var $0={};$0.task=task;$0.state=state;this.$0.add($0);},start:function(successCallBack,errorCallBack){this.$1=errorCallBack;this.$2=successCallBack;this.$3();},$3:function(){var $0=this.$0[0];if($0!=null){this.$0.remove($0);$0.task(ss.Delegate.create(this,this.$3),this.$1,$0.state);}else{if(this.$2!=null){this.$2();}}}}
Type.registerNamespace('SparkleXrm.ComponentModel');SparkleXrm.ComponentModel.INotifyPropertyChanged=function(){};SparkleXrm.ComponentModel.INotifyPropertyChanged.registerInterface('SparkleXrm.ComponentModel.INotifyPropertyChanged');Type.registerNamespace('SparkleXrm.Sdk');Type.registerNamespace('Xrm.Sdk');Xrm.Sdk.ParticipationTypeMask=function(){};Xrm.Sdk.ParticipationTypeMask.prototype = {sender:1,to_Recipient:2,cC_Recipient:3,bcC_Recipient:4,required_attendee:5,optional_attendee:6,organizer:7,regarding:8,owner:9,resource:10,customer:11}
Xrm.Sdk.ParticipationTypeMask.registerEnum('Xrm.Sdk.ParticipationTypeMask',false);SparkleXrm.Sdk.EntityStates=function(){};SparkleXrm.Sdk.EntityStates.prototype = {unchanged:0,created:1,changed:2,deleted:3,readOnly:4}
SparkleXrm.Sdk.EntityStates.registerEnum('SparkleXrm.Sdk.EntityStates',false);Xrm.Sdk.ServiceType=function(){};Xrm.Sdk.ServiceType.prototype = {soap2011:'soap2011',webApi:'webApi'}
Xrm.Sdk.ServiceType.registerEnum('Xrm.Sdk.ServiceType',false);SparkleXrm.Sdk.EntityRole=function(){};SparkleXrm.Sdk.EntityRole.prototype = {referencing:0,referenced:1}
SparkleXrm.Sdk.EntityRole.registerEnum('SparkleXrm.Sdk.EntityRole',false);SparkleXrm.Sdk.ColumnSet=function(columns){if(Type.getInstanceType(columns)===Boolean){this.allColumns=columns;}else{this.columns=columns;}}
SparkleXrm.Sdk.ColumnSet.prototype={allColumns:false,columns:null}
SparkleXrm.Sdk.Attribute=function(attributeName,typeName){this.attributeName=attributeName;this.typeName=typeName;this.formattedValue=null;this.value=null;this.id=null;this.logicalName=null;this.name=null;}
SparkleXrm.Sdk.Attribute.deSerialise=function(node,overrideType){var $0=(SparkleXrm.Sdk.XmlHelper.getAttributeValue(node,'i:nil')==='true');var $1=null;if(!$0){var $2=overrideType;if($2==null){$2=SparkleXrm.Sdk.Attribute.$0(SparkleXrm.Sdk.XmlHelper.getAttributeValue(node,'i:type'));}var $3=SparkleXrm.Sdk.XmlHelper.getNodeTextValue(node);switch($2){case 'EntityReference':var $4=new SparkleXrm.Sdk.EntityReference(new SparkleXrm.Sdk.Guid(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'Id')),SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'LogicalName'),SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'Name'));$1=$4;break;case 'AliasedValue':$1=SparkleXrm.Sdk.Attribute.deSerialise(SparkleXrm.Sdk.XmlHelper.selectSingleNode(node,'Value'),null);break;case 'boolean':$1=($3==='true');break;case 'double':$1=parseFloat($3);break;case 'decimal':$1=parseFloat($3);break;case 'dateTime':var $5=SparkleXrm.Sdk.DateTimeEx.parse($3);var $6=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings;if($6!=null){$5.setTime($5.getTime()+($5.getTimezoneOffset()*60*1000));var $7=SparkleXrm.Sdk.DateTimeEx.utcToLocalTimeFromSettings($5,$6);$1=$7;}else{$1=$5;}break;case 'guid':$1=new SparkleXrm.Sdk.Guid($3);break;case 'int':$1=parseInt($3);break;case 'OptionSetValue':$1=SparkleXrm.Sdk.OptionSetValue.parse(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'Value'));break;case 'Money':$1=new SparkleXrm.Sdk.Money(parseFloat(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'Value')));break;case 'EntityCollection':$1=SparkleXrm.Sdk.EntityCollection.deSerialise(node);break;default:$1=$3;break;}}return $1;}
SparkleXrm.Sdk.Attribute.serialise=function(attributeName,value,metaData){var $0='<a:KeyValuePairOfstringanyType><b:key>'+attributeName+'</b:key>';var $1=Type.getInstanceType(value).get_name();if(value!=null&&metaData!=null&&Object.keyExists(metaData,attributeName)){$1=metaData[attributeName];}$0+=SparkleXrm.Sdk.Attribute.serialiseValue(value,$1);$0+='</a:KeyValuePairOfstringanyType>';return $0;}
SparkleXrm.Sdk.Attribute.serialiseValue=function(value,overrideTypeName){var $0='';var $1=overrideTypeName;if($1==null){$1=Type.getInstanceType(value).get_name();}switch($1){case 'String':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('string')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';$0+=SparkleXrm.Sdk.XmlHelper.encode(value);$0+='</b:value>';break;case 'Boolean':case 'bool':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('boolean')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';$0+=SparkleXrm.Sdk.XmlHelper.encode(value.toString());$0+='</b:value>';break;case 'Date':var $2=value;var $3=null;var $4=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings;if($4!=null){var $D=SparkleXrm.Sdk.DateTimeEx.localTimeToUTCFromSettings($2,$4);$3=SparkleXrm.Sdk.DateTimeEx.toXrmString($D);}else{$3=SparkleXrm.Sdk.DateTimeEx.toXrmStringUTC($2);}$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('dateTime')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';$0+=SparkleXrm.Sdk.XmlHelper.encode($3);$0+='</b:value>';break;case 'decimal':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('decimal')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';var $5=null;if(value!=null){$5=value.toString();}$0+=SparkleXrm.Sdk.XmlHelper.encode($5);$0+='</b:value>';break;case 'double':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('double')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';var $6=null;if(value!=null){$6=value.toString();}$0+=SparkleXrm.Sdk.XmlHelper.encode($6);$0+='</b:value>';break;case 'int':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('int')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';var $7=null;if(value!=null){$7=parseInt(value).toString();}$0+=SparkleXrm.Sdk.XmlHelper.encode($7);$0+='</b:value>';break;case 'Guid':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('guid')+'" xmlns:c="http://schemas.microsoft.com/2003/10/Serialization/">';$0+=(value).value;$0+='</b:value>';break;case 'EntityReference':var $8=value;$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'">';$0+='<a:Id>'+$8.id+'</a:Id><a:LogicalName>'+$8.logicalName+'</a:LogicalName>';$0+='</b:value>';break;case 'OptionSetValue':var $9=value;if($9.value!=null){$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'">';$0+='<a:Value>'+$9.value+'</a:Value>';$0+='</b:value>';}else{$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'" i:nil="true"/>';}break;case 'EntityCollection':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'">';$0+=SparkleXrm.Sdk.EntityCollection.serialise(value);$0+='</b:value>';break;case 'Money':var $A=value;if($A!=null&&$A.value!=null){$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'">';$0+='<a:Value>'+$A.value.toString()+'</a:Value>';$0+='</b:value>';}else{$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'" i:nil="true"/>';}break;case 'EntityFilters':var $B=value;var $C=[];if((1&$B)===1){$C.add('Entity');}if((2&$B)===2){$C.add('Attributes');}if((4&$B)===4){$C.add('Privileges');}if((8&$B)===8){$C.add('Relationships');}$0+='<b:value i:type="c:EntityFilters" xmlns:c="http://schemas.microsoft.com/xrm/2011/Metadata">'+SparkleXrm.Sdk.XmlHelper.encode($C.join(' '))+'</b:value>';break;default:$0+='<b:value i:nil="true"/>';break;}return $0;}
SparkleXrm.Sdk.Attribute.$0=function($p0){var $0=$p0.indexOf(':');return $p0.substring($0+1,$p0.length-$0+1);}
SparkleXrm.Sdk.Attribute.$1=function($p0){switch($p0){case 'String':case 'Guid':case 'DateTime':case 'string':case 'decimal':case 'double':case 'boolean':case 'dateTime':case 'guid':case 'int':return 'c:'+$p0;case 'EntityReference':case 'OptionSetValue':case 'AliasedValue':case 'EntityCollection':case 'Money':return 'a:'+$p0;}throw new Error('Could not add node prefix for type '+$p0);}
SparkleXrm.Sdk.Attribute.$2=function($p0,$p1,$p2,$p3,$p4){var $0=Type.getInstanceType($p1);if($0===SparkleXrm.Sdk.EntityReference){var $1={};var $2=$p1;if($2.id==null||$2.id.value==null){throw new Error('Id not set on EntityReference');}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$13($2.logicalName,function($p1_0){
var $1_0=$p1_0.entitySetName;$1['@odata.id']=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$9($1_0,$2.id.value);$1['logicalName']=$2.logicalName;$p2($1);},$p3,$p4);}else if($0===SparkleXrm.Sdk.EntityCollection){var $3=$p1;SparkleXrm.Sdk.EntityCollection.serialiseWebApi($3,$p2,$p3,$p4);}else if($0===SparkleXrm.Sdk.Entity){var $4=$p1;SparkleXrm.Sdk.Entity.$2($4,$p2,$p3,$p4);}else if($0===SparkleXrm.Sdk.OptionSetValue){var $5=$p1;$p2($5.value);}else if($0===SparkleXrm.Sdk.Guid){var $6=$p1;$p2($6.value);}else if($0===SparkleXrm.Sdk.Money){var $7=$p1;$p2($7.value);}else{$p2($p1);}}
SparkleXrm.Sdk.Attribute.prototype={attributeName:null,typeName:null,formattedValue:null,value:null,id:null,logicalName:null,name:null}
SparkleXrm.Sdk.AttributeTypes=function(){}
SparkleXrm.Sdk.OrganizationSettings=function(){SparkleXrm.Sdk.OrganizationSettings.initializeBase(this,[SparkleXrm.Sdk.OrganizationSettings.entityLogicalName]);}
SparkleXrm.Sdk.OrganizationSettings.prototype={weekstartdaycode:null}
SparkleXrm.Sdk.UserSettingsAttributes=function(){}
SparkleXrm.Sdk.UserSettings=function(){SparkleXrm.Sdk.UserSettings.initializeBase(this,[SparkleXrm.Sdk.UserSettings.entityLogicalName]);}
SparkleXrm.Sdk.UserSettings.prototype={usersettingsid:null,businessunitid:null,calendartype:null,currencydecimalprecision:null,currencyformatcode:null,currencysymbol:null,dateformatcode:null,dateformatstring:null,dateseparator:null,decimalsymbol:null,defaultcalendarview:null,defaultdashboardid:null,localeid:null,longdateformatcode:null,negativecurrencyformatcode:null,negativeformatcode:null,numbergroupformat:null,numberseparator:null,offlinesyncinterval:null,pricingdecimalprecision:null,showweeknumber:null,systemuserid:null,timeformatcodestring:null,timeformatstring:null,timeseparator:null,timezonebias:null,timezonecode:null,timezonedaylightbias:null,timezonedaylightday:null,timezonedaylightdayofweek:null,timezonedaylighthour:null,timezonedaylightminute:null,timezonedaylightmonth:null,timezonedaylightsecond:null,timezonedaylightyear:null,timezonestandardbias:null,timezonestandardday:null,timezonestandarddayofweek:null,timezonestandardhour:null,timezonestandardminute:null,timezonestandardmonth:null,timezonestandardsecond:null,timezonestandardyear:null,transactioncurrencyid:null,uilanguageid:null,workdaystarttime:null,workdaystoptime:null,getNumberFormatString:function(decimalPlaces){return '###,###,###.000';}}
SparkleXrm.Sdk.DataCollectionOfEntity=function(entities){this._internalArray=entities;}
SparkleXrm.Sdk.DataCollectionOfEntity.prototype={_internalArray:null,items:function(){return this._internalArray;},getEnumerator:function(){return SparkleXrm.ArrayEx.getEnumerator(this._internalArray);},get_count:function(){return this._internalArray.length;},get_item:function(i){return this._internalArray[i];},set_item:function(i,value){this._internalArray[i]=value;return value;}}
SparkleXrm.Sdk.DateTimeEx=function(){}
SparkleXrm.Sdk.DateTimeEx.toXrmString=function(date){var $0=SparkleXrm.Sdk.DateTimeEx.$0(date.getMonth()+1,2);var $1=SparkleXrm.Sdk.DateTimeEx.$0(date.getDate(),2);var $2=SparkleXrm.Sdk.DateTimeEx.$0(date.getHours(),2);var $3=SparkleXrm.Sdk.DateTimeEx.$0(date.getMinutes(),2);var $4=SparkleXrm.Sdk.DateTimeEx.$0(date.getSeconds(),2);return String.format('{0}-{1}-{2}T{3}:{4}:{5}Z',date.getFullYear(),$0,$1,$2,$3,$4);}
SparkleXrm.Sdk.DateTimeEx.toXrmStringUTC=function(date){var $0=SparkleXrm.Sdk.DateTimeEx.$0(date.getUTCMonth()+1,2);var $1=SparkleXrm.Sdk.DateTimeEx.$0(date.getUTCDate(),2);var $2=SparkleXrm.Sdk.DateTimeEx.$0(date.getUTCHours(),2);var $3=SparkleXrm.Sdk.DateTimeEx.$0(date.getUTCMinutes(),2);var $4=SparkleXrm.Sdk.DateTimeEx.$0(date.getUTCSeconds(),2);return String.format('{0}-{1}-{2}T{3}:{4}:{5}Z',date.getUTCFullYear(),$0,$1,$2,$3,$4);}
SparkleXrm.Sdk.DateTimeEx.$0=function($p0,$p1){var $0=$p0.toString();while($0.length<$p1){$0='0'+$0;}return $0;}
SparkleXrm.Sdk.DateTimeEx.parse=function(dateString){if(!String.isNullOrEmpty(dateString)){var $0=(Date.parseDate(dateString));return $0;}else{return null;}}
SparkleXrm.Sdk.DateTimeEx.formatDuration=function(totalMinutes){if(totalMinutes!=null){var $0=totalMinutes*60;var $1=Math.floor($0/86400);var $2=Math.floor(($0%86400)/3600);var $3=Math.floor((($0%86400)%3600)/60);var $4=(($0%86400)%3600)%60;var $5=[];if($1>0){SparkleXrm.ArrayEx.add($5,'{0}d');}if($2>0){SparkleXrm.ArrayEx.add($5,'{1}h');}if($3>0){SparkleXrm.ArrayEx.add($5,'{2}m');}if(!$1&&!$2&&!$3){SparkleXrm.ArrayEx.add($5,'{2}m');}return String.format(SparkleXrm.ArrayEx.join($5,' '),$1,$2,$3);}else{return '';}}
SparkleXrm.Sdk.DateTimeEx.parseDuration=function(duration){var $0=(duration==null)||(!duration.length);if($0){return null;}var $1='/([0-9.]*)[ ]?((h(our)?[s]?)|(m(inute)?[s]?)|(d(ay)?[s]?))/g';var $2=RegExp.parse($1);var $3=false;var $4=false;var $5=0;do{var $6=$2.exec(duration);$4=($6!=null&&$6.length>0);$3=$3||$4;if($4){var $7=parseFloat($6[1]);switch($6[2].substr(0,1).toLowerCase()){case 'd':$7=$7*60*24;break;case 'h':$7=$7*60;break;}$5+=Math.floor($7);duration.replaceAll($6[0],'');}}while($4);if($3){return $5;}else{return null;}}
SparkleXrm.Sdk.DateTimeEx.addTimeToDate=function(date,time){if(date==null){date=Date.get_now();}if(time!=null){var $0=Date.parseDate('01 Jan 2000 '+time.replaceAll('.',':').replaceAll('-',':').replaceAll(',',':'));var $1=new Date(date.getTime());if(!isNaN(($0))){$1.setHours($0.getHours());$1.setMinutes($0.getMinutes());$1.setSeconds($0.getSeconds());$1.setMilliseconds($0.getMilliseconds());return $1;}return null;}return date;}
SparkleXrm.Sdk.DateTimeEx.localTimeToUTCFromSettings=function(LocalTime,settings){return SparkleXrm.Sdk.DateTimeEx.localTimeToUTC(LocalTime,settings.timezonebias,settings.timezonedaylightbias,settings.timezonedaylightyear,settings.timezonedaylightmonth,settings.timezonedaylightday,settings.timezonedaylighthour,settings.timezonedaylightminute,settings.timezonedaylightsecond,0,settings.timezonedaylightdayofweek,settings.timezonestandardbias,settings.timezonestandardyear,settings.timezonestandardmonth,settings.timezonestandardday,settings.timezonestandardhour,settings.timezonestandardminute,settings.timezonestandardsecond,0,settings.timezonestandarddayofweek);}
SparkleXrm.Sdk.DateTimeEx.localTimeToUTC=function(LocalTime,Bias,DaylightBias,DaylightYear,DaylightMonth,DaylightDay,DaylightHour,DaylightMinute,DaylightSecond,DaylightMilliseconds,DaylightWeekday,StandardBias,StandardYear,StandardMonth,StandardDay,StandardHour,StandardMinute,StandardSecond,StandardMilliseconds,StandardWeekday){var $0;var $1;var $2;var $3;var $4;var $5;var $6;$1=Bias;if((!!StandardMonth)&&(!!DaylightMonth)){$3=SparkleXrm.Sdk.DateTimeEx.$1(LocalTime,StandardYear,StandardMonth,StandardDay,StandardHour,StandardMinute,StandardSecond,StandardMilliseconds,StandardWeekday);if($3==null){return null;}$4=SparkleXrm.Sdk.DateTimeEx.$1(LocalTime,DaylightYear,DaylightMonth,DaylightDay,DaylightHour,DaylightMinute,DaylightSecond,DaylightMilliseconds,DaylightWeekday);if($4==null){return null;}if($4<$3){if((LocalTime>=$4)&&(LocalTime<$3)){$6=true;}else{$6=false;}}else{if((LocalTime>=$3)&&(LocalTime<$4)){$6=false;}else{$6=true;}}if($6){$2=DaylightBias;}else{$2=StandardBias;}$0=$1+$2;}else{$0=$1;}$5=SparkleXrm.Sdk.DateTimeEx.dateAdd('minutes',$0,LocalTime);return $5;}
SparkleXrm.Sdk.DateTimeEx.utcToLocalTimeFromSettings=function(UTCTime,settings){return SparkleXrm.Sdk.DateTimeEx.utcToLocalTime(UTCTime,settings.timezonebias,settings.timezonedaylightbias,settings.timezonedaylightyear,settings.timezonedaylightmonth,settings.timezonedaylightday,settings.timezonedaylighthour,settings.timezonedaylightminute,settings.timezonedaylightsecond,0,settings.timezonedaylightdayofweek,settings.timezonestandardbias,settings.timezonestandardyear,settings.timezonestandardmonth,settings.timezonestandardday,settings.timezonestandardhour,settings.timezonestandardminute,settings.timezonestandardsecond,0,settings.timezonestandarddayofweek);}
SparkleXrm.Sdk.DateTimeEx.utcToLocalTime=function(UTCTime,Bias,DaylightBias,DaylightYear,DaylightMonth,DaylightDay,DaylightHour,DaylightMinute,DaylightSecond,DaylightMilliseconds,DaylightWeekday,StandardBias,StandardYear,StandardMonth,StandardDay,StandardHour,StandardMinute,StandardSecond,StandardMilliseconds,StandardWeekday){var $0=0;var $1=0;var $2=0;var $3;var $4;var $5;var $6;var $7;var $8;$1=Bias;if((!!StandardMonth)&&(!!DaylightMonth)){$3=SparkleXrm.Sdk.DateTimeEx.$1(UTCTime,StandardYear,StandardMonth,StandardDay,StandardHour,StandardMinute,StandardSecond,StandardMilliseconds,StandardWeekday);if($3==null){return null;}$4=SparkleXrm.Sdk.DateTimeEx.$1(UTCTime,DaylightYear,DaylightMonth,DaylightDay,DaylightHour,DaylightMinute,DaylightSecond,DaylightMilliseconds,DaylightWeekday);if($4==null){return null;}$2=StandardBias;$0=$1+$2;$6=SparkleXrm.Sdk.DateTimeEx.dateAdd('minutes',$0,$4);$2=DaylightBias;$0=$1+$2;$5=SparkleXrm.Sdk.DateTimeEx.dateAdd('minutes',$0,$3);if($6<$5){if((UTCTime>=$6)&&(UTCTime<$5)){$8=true;}else{$8=false;}}else{if((UTCTime>=$5)&&(UTCTime<$6)){$8=false;}else{$8=true;}}if($8){$2=DaylightBias;}else{$2=StandardBias;}$0=$1+$2;}else{$0=$1;}$7=SparkleXrm.Sdk.DateTimeEx.dateAdd('minutes',$0*-1,UTCTime);return $7;}
SparkleXrm.Sdk.DateTimeEx.$1=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7,$p8){if(!!$p1){return null;}var $0;var $1;var $2;var $3;var $4;var $5;var $6;var $7;$4=$p3;if(($4>5)||(!$4)){return null;}$7=$p8;$6=$p2;$5=$p0.getFullYear();$2=0;$0=SparkleXrm.Sdk.DateTimeEx.firstDayOfMonth($p0,$6);$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('hours',$p4,$0);$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('minutes',$p5,$0);$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('seconds',$p6,$0);$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('milliseconds',$p7,$0);$1=$0;if($1.getDay()>$7){$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('days',(7-($1.getDay()-$7)),$0);}else if($1.getDay()<$7){$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('days',($7-$1.getDay()),$0);}$2=$0.getDay();$3=1;$1=$0;while($3<$4){$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('days',7,$0);if($0.getMonth()!==$1.getMonth()){break;}$1=$0;$3=$3+1;}return $1;}
SparkleXrm.Sdk.DateTimeEx.firstDayOfMonth=function(date,Month){var $0=new Date(date.getTime());$0.setMonth(Month-1);$0.setDate(1);$0.setHours(0);$0.setMinutes(0);$0.setSeconds(0);$0.setMilliseconds(0);return $0;}
SparkleXrm.Sdk.DateTimeEx.dateAdd=function(interval,value,date){var $0=date.getTime();var $1;switch(interval){case 'milliseconds':$1=new Date($0+value);break;case 'seconds':$1=new Date($0+(value*1000));break;case 'minutes':$1=new Date($0+(value*1000*60));break;case 'hours':$1=new Date($0+(value*1000*60*60));break;case 'days':$1=new Date($0+(value*1000*60*60*24));break;default:$1=date;break;}return $1;}
SparkleXrm.Sdk.DateTimeEx.firstDayOfWeek=function(date){var $0=0;if(SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings!=null){$0=SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings.weekstartdaycode.value;}var $1=new Date(date.getTime());var $2=$1.getDay();$2=$2-$0;if($2<0){$2=7+$2;}if($2>0){$1=SparkleXrm.Sdk.DateTimeEx.dateAdd('days',($2*-1),$1);}$1.setHours(0);$1.setMinutes(0);$1.setSeconds(0);$1.setMilliseconds(0);return $1;}
SparkleXrm.Sdk.DateTimeEx.lastDayOfWeek=function(date){var $0=0;if(SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings!=null){$0=SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings.weekstartdaycode.value;}var $1=new Date(date.getTime());var $2=$1.getDay();$2=$2-$0;if($2<0){$2=7+$2;}$1=SparkleXrm.Sdk.DateTimeEx.dateAdd('days',(6-$2),$1);$1.setHours(23);$1.setMinutes(59);$1.setSeconds(59);$1.setMilliseconds(999);return $1;}
SparkleXrm.Sdk.DateTimeEx.formatTimeSpecific=function(dateValue,formatString){formatString=formatString.replaceAll('.',':').replaceAll('-',':').replaceAll(',',':');if(dateValue!=null&&(Date===Type.getInstanceType(dateValue))){return dateValue.format(formatString);}else{return '';}}
SparkleXrm.Sdk.DateTimeEx.formatDateSpecific=function(dateValue,formatString){if(dateValue!=null){return xrmjQuery.datepicker.formatDate( formatString, dateValue );}else{return '';}}
SparkleXrm.Sdk.DateTimeEx.parseDateSpecific=function(dateValue,formatString){return xrmjQuery.datepicker.parseDate( formatString, dateValue );}
SparkleXrm.Sdk.DateTimeEx.setTime=function(date,time){if(date!=null&&time!=null){date.setHours(time.getHours());date.setMinutes(time.getMinutes());date.setSeconds(time.getSeconds());date.setMilliseconds(time.getMilliseconds());}}
SparkleXrm.Sdk.DateTimeEx.setUTCTime=function(date,time){if(date!=null&&time!=null){date.setUTCHours(time.getUTCHours());date.setUTCMinutes(time.getUTCMinutes());date.setUTCSeconds(time.getUTCSeconds());date.setUTCMilliseconds(time.getUTCMilliseconds());}}
SparkleXrm.Sdk.DateTimeEx.getTimeDuration=function(date){return (date.getHours()*(60*60))+(date.getMinutes()*60)+date.getSeconds();}
SparkleXrm.Sdk.Entity=function(entityName){this._metaData={};this.logicalName=entityName;this.$0={};this.formattedValues={};}
SparkleXrm.Sdk.Entity.setAttributeValueEntity=function(entity,name,value){if(entity.$0!=null){entity.$0[name]=value;}entity[name]=value;}
SparkleXrm.Sdk.Entity.sortDelegate=function(attributeName,a,b){var $0=a.getAttributeValue(attributeName);var $1=b.getAttributeValue(attributeName);var $2=0;var $3='';if($0!=null){$3=Type.getInstanceType($0).get_name();}else if($1!=null){$3=Type.getInstanceType($1).get_name();}if($0!==$1){switch($3.toLowerCase()){case 'string':$0=($0!=null)?($0).toLowerCase():null;$1=($1!=null)?($1).toLowerCase():null;if($0<$1){$2=-1;}else{$2=1;}break;case 'date':if($0==null){$2=-1;}else if($1==null){$2=1;}else if($0<$1){$2=-1;}else{$2=1;}break;case 'number':var $4=($0!=null)?($0):0;var $5=($1!=null)?($1):0;$2=($4-$5);break;case 'money':var $6=($0!=null)?($0).value:0;var $7=($1!=null)?($1).value:0;$2=($6-$7);break;case 'optionsetvalue':var $8=($0!=null)?($0).value:0;$8=($8!=null)?$8:0;var $9=($1!=null)?($1).value:0;$9=($9!=null)?$9:0;$2=($8-$9);break;case 'entityreference':var $A=(($0!=null)&&(($0).name!=null))?($0).name:'';var $B=($1!=null&&(($1).name!=null))?($1).name:'';if($A<$B){$2=-1;}else{$2=1;}break;}}return $2;}
SparkleXrm.Sdk.Entity.$2=function($p0,$p1,$p2,$p3){SparkleXrm.Sdk.WebApiOrganizationServiceProxy.addNavigationPropertyMetadata($p0.logicalName,'transactioncurrencyid','transactioncurrency');SparkleXrm.Sdk.WebApiOrganizationServiceProxy.addNavigationPropertyMetadata($p0.logicalName,'ownerid','systemuser,team');SparkleXrm.Sdk.WebApiOrganizationServiceProxy.addNavigationPropertyMetadata($p0.logicalName,'createdby','systemuser');SparkleXrm.Sdk.WebApiOrganizationServiceProxy.addNavigationPropertyMetadata($p0.logicalName,'modifiedby','systemuser');SparkleXrm.Sdk.WebApiOrganizationServiceProxy.addNavigationPropertyMetadata($p0.logicalName,'customerid','account,contact');var $0={};var $1=[];var $2={};var $3={};var $4={};var $5=[];$0['@odata.type']='Microsoft.Dynamics.CRM.'+$p0.logicalName;var $enum1=ss.IEnumerator.getEnumerator(Object.keys(($p0)));while($enum1.moveNext()){var $6=$enum1.current;if(SparkleXrm.Sdk.Entity.$3($p0,$6)){var $7=Type.getInstanceType($p0.getAttributeValue($6));var $8=$6;var $9=$p0.logicalName+'.'+$6;var $A=$p0.getAttributeValue($6);var $B=$A;if($7===SparkleXrm.Sdk.EntityReference&&$A!=null&&$6==='partyid'){$8+='_'+$B.logicalName;}else if(Object.keyExists(SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$4,$9)){$7=SparkleXrm.Sdk.EntityReference;if(SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$4[$9].length>1&&($A==null)){var $enum2=ss.IEnumerator.getEnumerator(SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$4[$9]);while($enum2.moveNext()){var $C=$enum2.current;$0[$8+'_'+$C+'@odata.bind']=null;}$8=null;$7=null;}else if(SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$4[$9].length>1&&($A!=null)){var $enum3=ss.IEnumerator.getEnumerator(SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$4[$9]);while($enum3.moveNext()){var $D=$enum3.current;if($D===$B.logicalName){$8+='_'+$D;break;}}}}if($8!=null){$3[$6]=$8;$4[$6]=$7;}if($7===SparkleXrm.Sdk.EntityReference){if($A!=null){$1.add($p0.getAttributeValueEntityReference($6));}$2[$6]=$8;}}}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.mapLookupsToEntitySets($1,function(){
SparkleXrm.DelegateItterator.callbackItterate(function($p2_0,$p2_1,$p2_2){
var $2_0=Object.keys($3)[$p2_0];var $2_1=$p0.getAttributeValue($2_0);var $2_2=$4[$2_0];SparkleXrm.Sdk.Attribute.$2($2_2,$2_1,function($p3_0){
var $3_0=$3[$2_0];if($2_2===SparkleXrm.Sdk.EntityReference){if($3_0==='record1id'||$3_0==='record2id'){if($p3_0!=null&&('logicalName' in $p3_0)){var $3_1=$p3_0.logicalName;$3_0=$3_0+'_'+$3_1;}}$3_0=$3_0+'@odata.bind';if($p3_0!=null&&('@odata.id' in $p3_0)){$p3_0=$p3_0['@odata.id'];}}if($2_2===SparkleXrm.Sdk.EntityCollection&&(($p3_0).length>0)&&($p3_0)[0]['@odata.type']==='Microsoft.Dynamics.CRM.activityparty'){var $3_2=2;switch($3_0){case 'to':$3_2=2;break;case 'from':$3_2=1;break;case 'bcc':$3_2=4;break;}var $enum1=ss.IEnumerator.getEnumerator(($p3_0));while($enum1.moveNext()){var $3_3=$enum1.current;$3_3.participationtypemask=$3_2;$5.add($3_3);}}else{$0[$3_0]=$p3_0;}$p2_1();},$p2,$p3);},Object.getKeyCount($3),function(){
if($5.length>0){$0[$p0.logicalName+'_activity_parties']=$5;}$p1($0);},function($p2_0){
$p2($p2_0);});},$p2,$p3);}
SparkleXrm.Sdk.Entity.$3=function($p0,$p1){return (typeof($p0[$p1])!="function"&&Object.prototype.hasOwnProperty.call($p0, $p1)&&!SparkleXrm.StringEx.IN($p1,['id','logicalName','entityState','formattedValues','relatedEntities'])&&!$p1.startsWith('$')&&!$p1.startsWith('_'));}
SparkleXrm.Sdk.Entity.deSerialiseWebApiStatic=function(entity,pojoEntity){if(String.isNullOrEmpty(entity.logicalName)){if(Object.keyExists(pojoEntity,'@odata.type')){entity.logicalName=(pojoEntity['@odata.type']).substr('#Microsoft.Dynamics.CRM.'.length);}else{throw new Error('Logical name not set');}}var $0=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$5[entity.logicalName];entity.id=pojoEntity[$0.primaryAttributeLogicalName];var $enum1=ss.IEnumerator.getEnumerator(Object.keys(pojoEntity));while($enum1.moveNext()){var $1=$enum1.current;var $2=$1.indexOf('@');var $3=$2>-1;var $4=$1.endsWith('@Microsoft.Dynamics.CRM.associatednavigationproperty');var $5=$1.startsWith('_');if((!$3&&!$5)||$4){var $6=null;var $7=null;var $8=$1;var $9=null;var $A=$1.substr(0,$2);if($4){$9=pojoEntity[$1];$8=$A;}var $B=$A+'@Microsoft.Dynamics.CRM.associatednavigationproperty';var $C=$A+'@Microsoft.Dynamics.CRM.lookuplogicalname';var $D=$8+'_base';var $E=$8+'@OData.Community.Display.V1.FormattedValue';if($8.endsWith('_activity_parties')){$7='EntityCollection';}else if($4&&Object.keyExists(pojoEntity,$C)){$7='EntityReference';}else if(Object.keyExists(pojoEntity,$D)){$7='Money';}else if(Object.keyExists(pojoEntity,$E)&&Type.getInstanceType(pojoEntity[$8])===Number){$7='OptionSetValue';}else if(entity._metaData!=null&&Object.keyExists(entity._metaData,$8)){$7=entity._metaData[$8];}switch($7){case 'EntityReference':var $F=pojoEntity[$C];$6=new SparkleXrm.Sdk.EntityReference(new SparkleXrm.Sdk.Guid(pojoEntity[$8]),$F,pojoEntity[$E]);var $10=pojoEntity[$B];if($10.endsWith('_'+$F)){var $13=$10.lastIndexOf('_'+$F);$8=$10.substr(0,$13);}else{$8=$10;}break;case 'Money':$6=new SparkleXrm.Sdk.Money(pojoEntity[$8]);break;case 'OptionSetValue':var $11=new SparkleXrm.Sdk.OptionSetValue(pojoEntity[$8]);$11.name=pojoEntity[$E];$6=$11;break;case 'EntityCollection':var $12={};$12['value']=pojoEntity[$8];$6=SparkleXrm.Sdk.EntityCollection.deserialiseWebApi(SparkleXrm.Sdk.Entity,'activityparty',$12);break;default:$6=pojoEntity[$8];break;}if($8.endsWith('_activity_parties')){var $14={};var $enum2=ss.IEnumerator.getEnumerator(($6).entities);while($enum2.moveNext()){var $15=$enum2.current;var $16=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$2[$15.getAttributeValueOptionSet('participationtypemask').value];if(!Object.keyExists($14,$16)){$14[$16]=[];}$14[$16].add($15);}var $enum3=ss.IEnumerator.getEnumerator(Object.keys($14));while($enum3.moveNext()){var $17=$enum3.current;SparkleXrm.Sdk.Entity.setAttributeValueEntity(entity,$17,new SparkleXrm.Sdk.EntityCollection($14[$17]));}}else{SparkleXrm.Sdk.Entity.setAttributeValueEntity(entity,$8,$6);}}}}
SparkleXrm.Sdk.Entity.prototype={_entitySetName:null,logicalName:null,id:null,entityState:0,$0:null,formattedValues:null,relatedEntities:null,deSerialise:function(entityNode){this.logicalName=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(entityNode,'LogicalName');this.id=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(entityNode,'Id');var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(entityNode,'Attributes');var $1=$0.childNodes.length;for(var $4=0;$4<$1;$4++){var $5=$0.childNodes[$4];try{var $6=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($5,'key');var $7=SparkleXrm.Sdk.Attribute.deSerialise(SparkleXrm.Sdk.XmlHelper.selectSingleNode($5,'value'),null);this.$0[$6]=$7;this[$6]=$7;}catch($8){throw new Error('Invalid Attribute Value :'+SparkleXrm.Sdk.XmlHelper.getNodeTextValue($5)+':'+$8.message);}}var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode(entityNode,'FormattedValues');if($2!=null){for(var $9=0;$9<$2.childNodes.length;$9++){var $A=$2.childNodes[$9];var $B=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($A,'key');var $C=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($A,'value');this[$B+'name']=$C;this.formattedValues[$B+'name']=$C;var $D=this.$0[$B];if($D!=null){$D.name=$C;}}}var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode(entityNode,'RelatedEntities');if($3!=null){var $E={};for(var $F=0;$F<$3.childNodes.length;$F++){var $10=$3.childNodes[$F];var $11=SparkleXrm.Sdk.XmlHelper.selectSingleNode($10,'key');var $12=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($11,'SchemaName');var $13=new SparkleXrm.Sdk.Relationship($12);var $14=SparkleXrm.Sdk.XmlHelper.selectSingleNode($10,'value');var $15=SparkleXrm.Sdk.EntityCollection.deSerialise($14);$E[$13.schemaName]=$15;}this.relatedEntities=$E;}},serialise:function(ommitRoot){var $0='';if(ommitRoot==null||!ommitRoot){$0+='<a:Entity>';}$0+='<a:Attributes>';var $1=(this);if($1[this.logicalName+'id']==null){delete $1[this.logicalName+'id'];}var $enum1=ss.IEnumerator.getEnumerator(Object.keys($1));while($enum1.moveNext()){var $2=$enum1.current;if(typeof($1[$2])!="function"&&Object.prototype.hasOwnProperty.call(this, $2)&&!SparkleXrm.StringEx.IN($2,['id','logicalName','entityState','formattedValues','relatedEntities'])&&!$2.startsWith('$')&&!$2.startsWith('_')){var $3=$1[$2];if(!Object.keyExists(this.formattedValues,$2)){$0+=SparkleXrm.Sdk.Attribute.serialise($2,$3,this._metaData);}}}$0+='</a:Attributes>';$0+='<a:LogicalName>'+this.logicalName+'</a:LogicalName>';if(this.id!=null){$0+='<a:Id>'+this.id+'</a:Id>';}if(ommitRoot==null||!ommitRoot){$0+='</a:Entity>';}return $0;},setAttributeValue:function(name,value){SparkleXrm.Sdk.Entity.setAttributeValueEntity(this,name,value);},getAttributeValue:function(attributeName){return this[attributeName];},getAttributeValueOptionSet:function(attributeName){return this.getAttributeValue(attributeName);},getAttributeValueGuid:function(attributeName){return this.getAttributeValue(attributeName);},getAttributeValueInt:function(attributeName){return this.getAttributeValue(attributeName);},getAttributeValueFloat:function(attributeName){return this.getAttributeValue(attributeName);},getAttributeValueString:function(attributeName){return this.getAttributeValue(attributeName);},getAttributeValueEntityReference:function(attributeName){return this.getAttributeValue(attributeName);},raisePropertyChanged:function(propertyName){var $0={};$0.propertyName=propertyName;if(this.$1!=null){this.$1(this,$0);}if(propertyName!=='EntityState'&&!this.entityState&&this.entityState!==1){this.entityState=2;}},toEntityReference:function(){return new SparkleXrm.Sdk.EntityReference(new SparkleXrm.Sdk.Guid(this.id),this.logicalName,'');},add_propertyChanged:function(value){this.$1=ss.Delegate.combine(this.$1,value);},remove_propertyChanged:function(value){this.$1=ss.Delegate.remove(this.$1,value);},$1:null,deSerialiseWebApi:function(pojoEntity){SparkleXrm.Sdk.Entity.deSerialiseWebApiStatic(this,pojoEntity);}}
SparkleXrm.Sdk.EntityCollection=function(entities){this.entities=new SparkleXrm.Sdk.DataCollectionOfEntity(entities);}
SparkleXrm.Sdk.EntityCollection.serialise=function(value){var $0='';if(Type.getInstanceType(value)!==SparkleXrm.Sdk.EntityCollection){throw new Error("An attribute value of type 'EntityCollection' must contain an EntityCollection instance");}var $1=Type.safeCast(value,SparkleXrm.Sdk.EntityCollection);$0+='<a:Entities>';for(var $2=0;$2<$1.entities.get_count();$2++){$0+=($1.get_item($2)).serialise(false);}$0+='</a:Entities>';return $0;}
SparkleXrm.Sdk.EntityCollection.deSerialise=function(node){var $0=[];var $1=new SparkleXrm.Sdk.EntityCollection($0);$1.entityName=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'EntityName');var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep(node,'Entities');var $enum1=ss.IEnumerator.getEnumerator($2.childNodes);while($enum1.moveNext()){var $3=$enum1.current;var $4=new SparkleXrm.Sdk.Entity($1.entityName);$4.deSerialise($3);SparkleXrm.ArrayEx.add($0,$4);}return $1;}
SparkleXrm.Sdk.EntityCollection.serialiseWebApi=function(collection,completeCallback,errorCallback,async){var $0=[];SparkleXrm.DelegateItterator.callbackItterate(function($p1_0,$p1_1,$p1_2){
SparkleXrm.Sdk.Entity.$2(collection.entities.get_item($p1_0),function($p2_0){
$0.add($p2_0);$p1_1();},errorCallback,async);},collection.entities.get_count(),function(){
completeCallback($0);},function($p1_0){
errorCallback($p1_0);});}
SparkleXrm.Sdk.EntityCollection.deserialiseWebApi=function(entityType,logicalName,results){var $0=[];var $enum1=ss.IEnumerator.getEnumerator(results['value']);while($enum1.moveNext()){var $2=$enum1.current;var $3=new entityType(logicalName);$3.deSerialiseWebApi($2);$0.add($3);}var $1=new SparkleXrm.Sdk.EntityCollection($0);if(results['@Microsoft.Dynamics.CRM.fetchxmlpagingcookie']!=null){$1.pagingCookie=results['@Microsoft.Dynamics.CRM.fetchxmlpagingcookie'];}if(results['@Microsoft.Dynamics.CRM.fetchxmlpagingcookie']!=null){$1.totalRecordCount=results['@Microsoft.Dynamics.CRM.totalrecordcount'];}return $1;}
SparkleXrm.Sdk.EntityCollection.prototype={entities:null,entityName:null,minActiveRowVersion:null,moreRecords:false,pagingCookie:null,totalRecordCount:0,totalRecordCountLimitExceeded:false,get_item:function(index){return this.entities.get_item(index);},set_item:function(index,value){this.entities.set_item(index,value);return value;}}
SparkleXrm.Sdk.EntityReference=function(Id,LogicalName,Name){this.id=Id;this.logicalName=LogicalName;this.name=Name;}
SparkleXrm.Sdk.EntityReference.prototype={name:null,id:null,logicalName:null,toString:function(){return String.format('[EntityReference: {0},{1},{2}]',this.name,this.id,this.logicalName);},toSoap:function(NameSpace){if(NameSpace==null||!NameSpace){NameSpace='a';}return String.format('<{0}:EntityReference><{0}:Id>{1}</{0}:Id><{0}:LogicalName>{2}</{0}:LogicalName><{0}:Name i:nil="true" /></{0}:EntityReference>',NameSpace,this.id.value,this.logicalName);}}
SparkleXrm.Sdk.Guid=function(Value){this.value=Value;}
SparkleXrm.Sdk.Guid.stripGuid=function(guid){return guid.replaceAll('{','').replaceAll('}','');}
SparkleXrm.Sdk.Guid.prototype={value:null,toString:function(){return this.value;},strip:function(){return SparkleXrm.Sdk.Guid.stripGuid(this.value);}}
SparkleXrm.Sdk.Money=function(value){this.value=value;}
SparkleXrm.Sdk.Money.prototype={value:0}
SparkleXrm.Sdk.OptionSetValue=function(value){this.value=value;}
SparkleXrm.Sdk.OptionSetValue.parse=function(value){if(String.isNullOrEmpty(value)){return new SparkleXrm.Sdk.OptionSetValue(null);}else{return new SparkleXrm.Sdk.OptionSetValue(parseInt(value));}}
SparkleXrm.Sdk.OptionSetValue.prototype={name:null,value:null}
Xrm.Sdk.OrganisationServiceMetadata=function(){}
Xrm.Sdk.OrganisationServiceMetadata.registerExecuteMessageResponseType=function(responseTypeName,organizationResponseType){Xrm.Sdk.OrganisationServiceMetadata.executeMessageResponseTypes[responseTypeName]=organizationResponseType;}
SparkleXrm.Sdk.OrganizationServiceProxy=function(){}
SparkleXrm.Sdk.OrganizationServiceProxy.setImplementation=function(type){switch(type){case 'soap2011':throw new Error('Not supported');case 'webApi':SparkleXrm.Sdk.OrganizationServiceProxy.$0=new SparkleXrm.Sdk.WebApiOrganizationServiceProxy();break;}}
SparkleXrm.Sdk.OrganizationServiceProxy.registerExecuteMessageResponseType=function(responseTypeName,organizationResponseType){SparkleXrm.Sdk.OrganizationServiceProxy.$0.registerExecuteMessageResponseType(responseTypeName,organizationResponseType);}
SparkleXrm.Sdk.OrganizationServiceProxy.getUserSettings=function(){return SparkleXrm.Sdk.OrganizationServiceProxy.$0.getUserSettings();}
SparkleXrm.Sdk.OrganizationServiceProxy.doesNNAssociationExist=function(relationship,Entity1,Entity2){return SparkleXrm.Sdk.OrganizationServiceProxy.$0.doesNNAssociationExist(relationship,Entity1,Entity2);}
SparkleXrm.Sdk.OrganizationServiceProxy.associate=function(entityName,entityId,relationship,relatedEntities){SparkleXrm.Sdk.OrganizationServiceProxy.$0.associate(entityName,entityId,relationship,relatedEntities);}
SparkleXrm.Sdk.OrganizationServiceProxy.beginAssociate=function(entityName,entityId,relationship,relatedEntities,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$0.beginAssociate(entityName,entityId,relationship,relatedEntities,callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endAssociate=function(asyncState){SparkleXrm.Sdk.OrganizationServiceProxy.$0.endAssociate(asyncState);}
SparkleXrm.Sdk.OrganizationServiceProxy.disassociate=function(entityName,entityId,relationship,relatedEntities){SparkleXrm.Sdk.OrganizationServiceProxy.$0.disassociate(entityName,entityId,relationship,relatedEntities);}
SparkleXrm.Sdk.OrganizationServiceProxy.beginDisassociate=function(entityName,entityId,relationship,relatedEntities,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$0.beginDisassociate(entityName,entityId,relationship,relatedEntities,callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endDisassociate=function(asyncState){SparkleXrm.Sdk.OrganizationServiceProxy.$0.endDisassociate(asyncState);}
SparkleXrm.Sdk.OrganizationServiceProxy.retrieveMultiple=function(fetchXml){return SparkleXrm.Sdk.OrganizationServiceProxy.$0.retrieveMultiple(fetchXml);}
SparkleXrm.Sdk.OrganizationServiceProxy.beginRetrieveMultiple=function(fetchXml,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$0.beginRetrieveMultiple(fetchXml,callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endRetrieveMultiple=function(asyncState,entityType){return SparkleXrm.Sdk.OrganizationServiceProxy.$0.endRetrieveMultiple(asyncState,entityType);}
SparkleXrm.Sdk.OrganizationServiceProxy.retrieve=function(entityName,entityId,attributesList){return SparkleXrm.Sdk.OrganizationServiceProxy.$0.retrieve(entityName,entityId,attributesList);}
SparkleXrm.Sdk.OrganizationServiceProxy.beginRetrieve=function(entityName,entityId,attributesList,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$0.beginRetrieve(entityName,entityId,attributesList,callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endRetrieve=function(asyncState,entityType){return SparkleXrm.Sdk.OrganizationServiceProxy.$0.endRetrieve(asyncState,entityType);}
SparkleXrm.Sdk.OrganizationServiceProxy.create=function(entity){return SparkleXrm.Sdk.OrganizationServiceProxy.$0.create(entity);}
SparkleXrm.Sdk.OrganizationServiceProxy.beginCreate=function(entity,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$0.beginCreate(entity,callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endCreate=function(asyncState){return SparkleXrm.Sdk.OrganizationServiceProxy.$0.endCreate(asyncState);}
SparkleXrm.Sdk.OrganizationServiceProxy.setState=function(id,entityName,stateCode,statusCode){SparkleXrm.Sdk.OrganizationServiceProxy.$0.setState(id,entityName,stateCode,statusCode);}
SparkleXrm.Sdk.OrganizationServiceProxy.beginSetState=function(id,entityName,stateCode,statusCode,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$0.beginSetState(id,entityName,stateCode,statusCode,callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endSetState=function(asyncState){SparkleXrm.Sdk.OrganizationServiceProxy.$0.endSetState(asyncState);}
SparkleXrm.Sdk.OrganizationServiceProxy.delete_=function(entityName,id){return SparkleXrm.Sdk.OrganizationServiceProxy.$0.delete_(entityName,id);}
SparkleXrm.Sdk.OrganizationServiceProxy.beginDelete=function(entityName,id,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$0.beginDelete(entityName,id,callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endDelete=function(asyncState){SparkleXrm.Sdk.OrganizationServiceProxy.$0.endDelete(asyncState);}
SparkleXrm.Sdk.OrganizationServiceProxy.update=function(entity){SparkleXrm.Sdk.OrganizationServiceProxy.$0.update(entity);}
SparkleXrm.Sdk.OrganizationServiceProxy.beginUpdate=function(entity,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$0.beginUpdate(entity,callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endUpdate=function(asyncState){SparkleXrm.Sdk.OrganizationServiceProxy.$0.endUpdate(asyncState);}
SparkleXrm.Sdk.OrganizationServiceProxy.execute=function(request){return SparkleXrm.Sdk.OrganizationServiceProxy.$0.execute(request);}
SparkleXrm.Sdk.OrganizationServiceProxy.beginExecute=function(request,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$0.beginExecute(request,callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endExecute=function(asyncState){return SparkleXrm.Sdk.OrganizationServiceProxy.$0.endExecute(asyncState);}
SparkleXrm.Sdk.XrmService=function(){}
SparkleXrm.Sdk.XrmService.Create=function(contact){return new Promise(function($p1_0,$p1_1){
SparkleXrm.Sdk.OrganizationServiceProxy.beginCreate(contact,function($p2_0){
try{$p1_0(SparkleXrm.Sdk.OrganizationServiceProxy.endCreate($p2_0));}catch($2_0){$p1_1($2_0);}});});}
SparkleXrm.Sdk.XrmService.Retrieve=function(entityName,id,columnSet){var $0=id;if(Type.getInstanceType(id)===SparkleXrm.Sdk.Guid){$0=(id).value;}return new Promise(function($p1_0,$p1_1){
var $1_0;if(columnSet.allColumns){$1_0=['AllColumns'];}else{$1_0=columnSet.columns;}SparkleXrm.Sdk.OrganizationServiceProxy.beginRetrieve(entityName,$0,$1_0,function($p2_0){
try{var $2_0=SparkleXrm.Sdk.OrganizationServiceProxy.endRetrieve($p2_0,SparkleXrm.Sdk.Entity);$p1_0($2_0);}catch($2_1){$p1_1($2_1);}});});}
SparkleXrm.Sdk.XrmService.Update=function(contact){return new Promise(function($p1_0,$p1_1){
SparkleXrm.Sdk.OrganizationServiceProxy.beginUpdate(contact,function($p2_0){
try{SparkleXrm.Sdk.OrganizationServiceProxy.endUpdate($p2_0);$p1_0(null);}catch($2_0){$p1_1($2_0);}});});}
SparkleXrm.Sdk.XrmService.Delete=function(entityName,id){return new Promise(function($p1_0,$p1_1){
SparkleXrm.Sdk.OrganizationServiceProxy.beginDelete(entityName,id,function($p2_0){
try{SparkleXrm.Sdk.OrganizationServiceProxy.endDelete($p2_0);$p1_0(null);}catch($2_0){$p1_1($2_0);}});});}
SparkleXrm.Sdk.Relationship=function(schemaName){this.schemaName=schemaName;}
SparkleXrm.Sdk.Relationship.prototype={primaryEntityRole:0,schemaName:null}
SparkleXrm.Sdk.RetrieveRelationshipRequest=function(){this.MetadataId=SparkleXrm.Sdk.Guid.empty;}
SparkleXrm.Sdk.RetrieveRelationshipRequest.prototype={Name:null,RetrieveAsIfPublished:false,serialise:function(){return '<request i:type="a:RetrieveRelationshipRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">'+'<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'<a:KeyValuePairOfstringanyType>'+'<b:key>MetadataId</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.MetadataId,null)+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>Name</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.Name,null)+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>RetrieveAsIfPublished</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.RetrieveAsIfPublished,null)+'</a:KeyValuePairOfstringanyType>'+'</a:Parameters>'+'<a:RequestId i:nil="true" />'+'<a:RequestName>RetrieveRelationship</a:RequestName>'+'</request>';},serialiseWebApi:function(){var $0=new SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties();$0.CustomImplementation=ss.Delegate.create(this,this.$0);return $0;},$0:function($p0,$p1,$p2,$p3){var $0=$p0;var $1="$filter=SchemaName eq '"+$0.Name+"'";SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17('RelationshipDefinition','RelationshipDefinitions',$1,'GET',null,$p3,function($p1_0){
var $1_0=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$10($p1_0);var $1_1=$1_0['value'];var $1_2=new SparkleXrm.Sdk.RetrieveRelationshipResponse(null);var $1_3=$1_1;$1_2.RelationshipMetadata=$1_3[0];$p1($1_2);},$p2);}}
SparkleXrm.Sdk.RetrieveRelationshipResponse=function(response){if(response==null){return;}var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='RelationshipMetadata'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');this.RelationshipMetadata=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseRelationshipMetadata($3);}}}
SparkleXrm.Sdk.RetrieveRelationshipResponse.prototype={RelationshipMetadata:null}
SparkleXrm.Sdk.WebApiRequestResponse=function(request,logicalName){this.response=request.responseText;this.headers=request.getAllResponseHeaders();this.logicalName=logicalName;}
SparkleXrm.Sdk.WebApiRequestResponse.prototype={response:null,headers:null,logicalName:null,$0:null,getHeader:function(key){if(this.$0==null){this.$0={};var $0=this.headers.split('\r\n');var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $1=$enum1.current;var $2=$1.split(': ');if($2.length===2){this.$0[$2[0]]=$2[1];}}}return this.$0[key];}}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy=function(){}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.addNavigationPropertyMetadata=function(entityLogicalName,attributeLogicalName,navigationProperties){var $0=navigationProperties.split(',');var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $1=$enum1.current;SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$3[entityLogicalName+'.'+navigationProperties]=attributeLogicalName;}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$4[entityLogicalName+'.'+attributeLogicalName]=$0;}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.addMetadata=function(logicalName,entitySetName,primaryAttributeLogicalName){var $0={};$0.logicalName=logicalName;$0.entitySetName=entitySetName;$0.primaryAttributeLogicalName=primaryAttributeLogicalName;SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$5[logicalName]=$0;}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$9=function($p0,$p1){return $p0+'('+SparkleXrm.Sdk.Guid.stripGuid($p1)+')';}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.mapLookupsToEntitySets=function(lookups,completeCallback,errorCallBack,async){SparkleXrm.DelegateItterator.callbackItterate(function($p1_0,$p1_1,$p1_2){
var $1_0=lookups[$p1_0];var $1_1=null;var $1_2=null;if(Type.getInstanceType($1_0)===SparkleXrm.Sdk.EntityReference){$1_1=($1_0).logicalName;$1_2=function($p2_0){
$p1_1();};}else if(Type.getInstanceType($1_0)===SparkleXrm.Sdk.Entity){$1_1=($1_0).logicalName;$1_2=function($p2_0){
($1_0)._entitySetName=$p2_0.entitySetName;$p1_1();};}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$13($1_1,$1_2,function($p2_0){
$p1_2($p2_0);},async);},lookups.length,completeCallback,function($p1_0){
errorCallBack($p1_0);});}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$10=function($p0){var $0=$p0;var $1=JSON.parse($0.response,SparkleXrm.Sdk.WebApiOrganizationServiceProxy.dateReviver);return $1;}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$13=function($p0,$p1,$p2,$p3){SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$14([$p0],function($p1_0){
$p1($p1_0[0]);},$p2,$p3);}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$14=function($p0,$p1,$p2,$p3){var $0=[];var $1=[];var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $2=$enum1.current;if(Object.keyExists(SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$5,$2)){$0.add(SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$5[$2]);}else{$1.add($2);}}if(!$1.length){$p1($0);return;}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17(null,'EntityDefinitions',"$select=EntitySetName,LogicalName,PrimaryIdAttribute&$filter=LogicalName+eq+'"+$p0.join("' or LogicalName+eq+'")+"'",'GET',null,$p3,function($p1_0){
var $1_0=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1B(SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$15($p1_0));var $1_1=$1_0['value'];if($1_1==null||$1_1.length!==$p0.length){$p2(new Error(String.format("Invalid logical name(s) '{0}'",$p0)));return;}var $enum1=ss.IEnumerator.getEnumerator($1_1);while($enum1.moveNext()){var $1_2=$enum1.current;var $1_3=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.getMetadata($1_2);$0.add($1_3);}$p1($0);},$p2);}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.getMetadata=function(row){var $0={};$0.logicalName=row['LogicalName'];$0.primaryAttributeLogicalName=row['PrimaryIdAttribute'];$0.entitySetName=row['EntitySetName'];SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$5[$0.logicalName]=$0;return $0;}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$15=function($p0){if(Type.getInstanceType($p0)===SparkleXrm.Sdk.WebApiRequestResponse){return $p0;}else{throw $p0;}}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7){var $0=new XMLHttpRequest();var $1=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$18($p1,$p2);$0.open($p3,encodeURI($1),$p5);SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1C($0,null,$p1.endsWith('$batch'));if($p5){$0.onreadystatechange=function(){
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$19($0,function($p2_0){
var $2_0=new SparkleXrm.Sdk.WebApiRequestResponse($p2_0,$p0);delete $0;$p6($2_0);},$p7);};$0.send($p4);}else{delete $0;$0.send($p4);SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$19($0,function($p1_0){
var $1_0=new SparkleXrm.Sdk.WebApiRequestResponse($p1_0,$p0);$p6($1_0);},$p7);}}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$18=function($p0,$p1){var $0=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1D()+$p0;if(!String.isNullOrEmpty($p1)){$0+=('?'+$p1);}return $0;}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$19=function($p0,$p1,$p2){if($p0.readyState===4){$p0.onreadystatechange=null;switch($p0.status){case 200:case 204:case 304:$p1($p0);break;default:var $0=null;try{var $1=JSON.parse($p0.responseText,null);$0=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1A($1);}catch($2){$0=$2;}$p2($0);break;}}}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1A=function($p0){var $0;var $1='Unknown';if(!String.isNullOrEmpty($p0.Message)){$1=$p0.Message;}else if($p0.error!=null){$1=$p0.error.message;}$0=new Error($1);if($p0.error!=null&&$p0.error.stacktrace!=null){}return $0;}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.dateReviver=function(key,value){if(String===Type.getInstanceType(value)){var $0=new RegExp('^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2}(?:\\.\\d *)?)Z$').exec(value);if($0!=null){return new Date(Date.UTC(parseInt($0[1]),parseInt($0[2])-1,parseInt($0[3]),parseInt($0[4]),parseInt($0[5]),parseInt($0[6])));}var $1=new RegExp('^[{(]?[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}[)}]?$').exec(value);if($1!=null){return new SparkleXrm.Sdk.Guid(value);}}return value;}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1B=function($p0){var $0=$p0.response;if($0.startsWith('--batchresponse')){var $1={};$1.batches=[];var $2=0;var $3='--batchresponse';while(true){$2=$0.indexOf($3,$2);if($2===-1){break;}var $4=$0.indexOf('\n',$2);$3=$0.substring($2,$4-1);var $5={};$5.batchId=$3;var $6='HTTP/1.1';var $7=$0.indexOf($6);if($7>-1){var $9=$0.indexOf(' ',$7+$6.length+1);$5.httpResponseCode=parseInt($0.substring($7+$6.length+1,$9));}var $8=$0.indexOf($3,$4);if($8>-1){var $A=$0.indexOf('{');var $B=$0.substring($A,$8);$2=$8+1;$5.response=JSON.parse($B,SparkleXrm.Sdk.WebApiOrganizationServiceProxy.dateReviver);$1.batches.add($5);}}return $1;}else{return JSON.parse($0,SparkleXrm.Sdk.WebApiOrganizationServiceProxy.dateReviver);}}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1C=function($p0,$p1,$p2){$p0.setRequestHeader('Accept','application/json');if($p2){$p0.setRequestHeader('Content-Type','multipart/mixed;boundary=batch_boundary');}else{$p0.setRequestHeader('Content-Type','application/json; charset=utf-8');}$p0.setRequestHeader('OData-MaxVersion','4.0');$p0.setRequestHeader('OData-Version','4.0');$p0.setRequestHeader('Prefer','odata.include-annotations="*"');if($p1!=null){$p0.setRequestHeader('Prefer','odata.maxpagesize='+$p1);}}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1D=function(){return SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1E()+'/api/data/v'+SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1+'/';}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1E=function(){if(SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$0==null){SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$0=Xrm.Page.context.getClientUrl();var $0=Xrm.Page.context.getVersion();if(!String.isNullOrEmpty($0)){var $1=$0.indexOf('.');var $2=$0.indexOf('.',$1+1);SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1=$0.substr(0,$2);}}return SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$0;}
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.prototype={doesNNAssociationExist:function(relationship,Entity1,Entity2){throw new Error('Not Implemented');},setState:function(id,entityName,stateCode,statusCode){throw new Error('Not Implemented');},beginSetState:function(id,entityName,stateCode,statusCode,callBack){throw new Error('Not Implemented');},endSetState:function(asyncState){throw new Error('Not Implemented');},getUserSettings:function(){if(SparkleXrm.Sdk.OrganizationServiceProxy.userSettings==null){SparkleXrm.Sdk.OrganizationServiceProxy.userSettings=SparkleXrm.Sdk.OrganizationServiceProxy.retrieve(SparkleXrm.Sdk.UserSettings.entityLogicalName,Xrm.Page.context.getUserId(),['timeformatstring','dateformatstring']);SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.timeformatstring=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.timeformatstring.replaceAll(':',SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.timeseparator);SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.dateformatstring=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.dateformatstring.replaceAll('/',SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.dateseparator);SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.dateformatstring=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.dateformatstring.replaceAll('MM','mm').replaceAll('yyyy','UU').replaceAll('yy','y').replaceAll('UU','yy').replaceAll('M','m');}if(SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings==null){var $0="<fetch>\r\n                                    <entity name='organization' >\r\n                                        <attribute name='weekstartdaycode' />\r\n                                    </entity>\r\n                                </fetch>";SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings=this.retrieveMultiple($0).entities.get_item(0);}return SparkleXrm.Sdk.OrganizationServiceProxy.userSettings;},registerExecuteMessageResponseType:function(responseTypeName,organizationResponseType){Xrm.Sdk.OrganisationServiceMetadata.registerExecuteMessageResponseType(responseTypeName,organizationResponseType);},create:function(entity){return this.$6(entity,null);},beginCreate:function(entity,callBack){this.$6(entity,callBack);},$6:function($p0,$p1){var $0=null;var $1=!ss.isNullOrUndefined($p1);var $2=(!$1)?ss.Delegate.create(this,this.$12):$p1;var $3=(!$1)?ss.Delegate.create(this,function($p1_0){
$0=this.endCreate($p1_0);}):$p1;SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$13($p0.logicalName,function($p1_0){
SparkleXrm.Sdk.Entity.$2($p0,function($p2_0){
var $2_0=$p2_0;var $enum1=ss.IEnumerator.getEnumerator(Object.keys($2_0));while($enum1.moveNext()){var $2_2=$enum1.current;if($2_2.endsWith('@odata.bind')&&$2_0[$2_2]==null){delete $p2_0[$2_2];}}var $2_1=JSON.stringify($p2_0);SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17($p0.logicalName,$p1_0.entitySetName,null,'POST',$2_1,$1,$3,$2);},$2,$1);},$2,$1);return $0;},endCreate:function(asyncState){this.$8(asyncState);var $0=asyncState;var $1=$0.getHeader('OData-EntityId');if($1==null){$1=$0.getHeader('odata-entityid');}var $2=new RegExp('\\(([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})\\)','g');var $3=$2.exec($1);if($3.length>0){return new SparkleXrm.Sdk.Guid($3[1]);}else{throw new Error('Invalid response');}},update:function(entity){this.beginUpdateInternal(entity,null);},beginUpdate:function(entity,callBack){this.beginUpdateInternal(entity,callBack);},beginUpdateInternal:function(entity,callBack){var $0=!ss.isNullOrUndefined(callBack);var $1=(!$0)?ss.Delegate.create(this,this.$12):callBack;var $2=(!$0)?ss.Delegate.create(this,this.endUpdate):callBack;SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$13(entity.logicalName,function($p1_0){
SparkleXrm.Sdk.Entity.$2(entity,function($p2_0){
var $2_0=$p2_0;var $2_1=[];var $enum1=ss.IEnumerator.getEnumerator(Object.keys($2_0));while($enum1.moveNext()){var $2_2=$enum1.current;if($2_2.endsWith('@odata.bind')&&$2_0[$2_2]==null){$2_1.add($2_2);}}SparkleXrm.DelegateItterator.callbackItterate(function($p3_0,$p3_1,$p3_2){
var $3_0=$2_1[$p3_0];var $3_1=$3_0.substr(0,$3_0.length-11);delete $p2_0[$3_0];SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17(entity.logicalName,SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$9($p1_0.entitySetName,entity.id)+'/'+$3_1+'/$ref',null,'DELETE',null,$0,function($p4_0){
$p3_1();},$1);},$2_1.length,function(){
var $3_0=JSON.stringify($p2_0);SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17(entity.logicalName,SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$9($p1_0.entitySetName,entity.id),null,'PATCH',$3_0,$0,$2,$1);},function($p3_0){
$1($p3_0);});},$1,$0);},$1,$0);},endUpdate:function(asyncState){this.$8(asyncState);},delete_:function(logicalName,guid){this.$7(logicalName,guid,null);return null;},beginDelete:function(logicalName,guid,callBack){this.$7(logicalName,guid,callBack);},$7:function($p0,$p1,$p2){var $0=!ss.isNullOrUndefined($p2);var $1=(!$0)?ss.Delegate.create(this,this.$12):$p2;var $2=(!$0)?ss.Delegate.create(this,this.endDelete):$p2;SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$13($p0,function($p1_0){
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17($p0,SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$9($p1_0.entitySetName,$p1.value),null,'DELETE',null,$0,$2,$1);},$1,$0);},endDelete:function(asyncState){this.$8(asyncState);},$8:function($p0){if(Type.getInstanceType($p0)===Error){throw $p0;}},execute:function(request){return this.$A(request,null);},beginExecute:function(request,callBack){this.$A(request,callBack);},$A:function($p0,$p1){var $0=$p0;var $1=null;try{$1=$0.serialiseWebApi();}catch($B){throw new Error('Cannot create webapi request '+$B.message);}var $2=null;var $3=!ss.isNullOrUndefined($p1);var $4=(!$3)?ss.Delegate.create(this,this.$12):$p1;var $5=($1.RequestName!=null)?$1.RequestName.replaceAll('Microsoft.Dynamics.CRM.',''):'';var $6=($1.CustomImplementation!=null);var $7=(!$3)?ss.Delegate.create(this,function($p1_0){
if($6){$p1_0._customImplementation=true;}$p1_0._requestName=$5;$2=this.endExecute($p1_0);}):function($p1_0){
if($6){$p1_0._customImplementation=true;}$p1_0._requestName=$5;$p1($p1_0);};if($6){$1.CustomImplementation($p0,$7,$4,$3);return $2;}var $8=($1.OperationType==='functionCall')?'GET':'POST';var $9=null;var $A=function($p1_0){
var $1_0='';var $1_1='';var $1_2='';if($1.OperationType==='functionCall'){var $1_6=[];var $1_7=[];var $1_8=1;var $enum1=ss.IEnumerator.getEnumerator(Object.keys($p1_0));while($enum1.moveNext()){var $1_9=$enum1.current;var $1_A='@p'+$1_8.toString();var $1_B=$p1_0[$1_9];var $1_C=Type.getInstanceType($1_B);if($1_C===String){$1_B="'"+($1_B).replaceAll("'","'")+"'";}else{$1_B=JSON.stringify($1_B);}$1_6.add($1_9+'='+$1_A);$1_7.add($1_A+'='+$1_B);$1_8++;}$1_0=$1_6.join(',');$1_1=$1_7.join('&');}else{$1_2=JSON.stringify($p1_0);}var $1_3=($9!=null)?$9.entitySetName:null;var $1_4=($1.BoundEntityId!=null)?$1.BoundEntityId.value:null;var $1_5=($1_3!=null)?SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$9($1_3,$1_4)+'/':'';SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17($1.BoundEntityLogicalName,$1_5+$1.RequestName+'('+$1_0+')',$1_1,$8,$1_2,$3,$7,$4);};if($1.BoundEntityLogicalName!=null){SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$13($1.BoundEntityLogicalName,ss.Delegate.create(this,function($p1_0){
$9=$p1_0;this.$B($1,$A,$4,$3);}),$4,$3);}else{this.$B($1,$A,$4,$3);}return $2;},$B:function($p0,$p1,$p2,$p3){var $0={};var $1=[];var $2=$p0.AdditionalProperties;var $enum1=ss.IEnumerator.getEnumerator(Object.keys($2));while($enum1.moveNext()){var $3=$enum1.current;var $4=$2[$3];var $5=Type.getInstanceType($4);if($5===SparkleXrm.Sdk.EntityReference||$5===SparkleXrm.Sdk.Entity){$1.add($4);}$0[$3]=$4;}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.mapLookupsToEntitySets($1,function(){
SparkleXrm.DelegateItterator.callbackItterate(function($p2_0,$p2_1,$p2_2){
var $2_0=Object.keys($0)[$p2_0];var $2_1=$0[$2_0];SparkleXrm.Sdk.Attribute.$2(Type.getInstanceType($2_1),$2_1,function($p3_0){
$0[$2_0]=$p3_0;$p2_1();},$p2,$p3);},Object.getKeyCount($0),function(){
$p1($0);},function($p2_0){
$p2($p2_0);});},$p2,$p3);},$C:function($p0,$p1,$p2,$p3){SparkleXrm.DelegateItterator.callbackItterate(function($p1_0,$p1_1,$p1_2){
},Object.getKeyCount($p0.AdditionalProperties),function(){
},function($p1_0){
$p2($p1_0);});},endExecute:function(asyncState){this.$8(asyncState);var $0=asyncState._requestName;var $1=('_customImplementation' in asyncState);if($1){return asyncState;}if(Object.keyExists(Xrm.Sdk.OrganisationServiceMetadata.executeMessageResponseTypes,$0)){var $2=Xrm.Sdk.OrganisationServiceMetadata.executeMessageResponseTypes[$0];var $3=new $2();var $4=asyncState.response;var $5=null;if(!String.isNullOrEmpty($4)){$5=JSON.parse($4);}$3.deserialiseWebApi($5);return $3;}return null;},retrieveMultiple:function(fetchXml){return this.$D(fetchXml,SparkleXrm.Sdk.Entity,null);},beginRetrieveMultiple:function(fetchXml,callBack){this.$D(fetchXml,null,callBack);},$D:function($p0,$p1,$p2){var $0=null;var $1=!ss.isNullOrUndefined($p2);var $2=(!$1)?ss.Delegate.create(this,this.$12):$p2;var $3=(!$1)?ss.Delegate.create(this,function($p1_0){
$0=this.endRetrieveMultiple($p1_0,$p1);}):$p2;var $4='';try{var $5=SparkleXrm.Sdk.XmlHelper.loadXml($p0);var $6=$5.childNodes[0];var $enum1=ss.IEnumerator.getEnumerator($6.childNodes);while($enum1.moveNext()){var $7=$enum1.current;if($7.nodeName.toLowerCase()==='entity'){var $enum2=ss.IEnumerator.getEnumerator($7.attributes);while($enum2.moveNext()){var $8=$enum2.current;if($8.name.toLowerCase()==='name'){$4=$8.value;break;}}break;}}}catch($9){throw new Error('Invalid FetchXml '+$9.message);}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$13($4,ss.Delegate.create(this,function($p1_0){
var $1_0='fetchXml='+encodeURIComponent($p0);var $1_1=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$18($p1_0.entitySetName,$1_0);var $1_2=$p1_0.entitySetName;var $1_3='GET';var $1_4=null;if(this.$E($1_1)){$1_2='$batch';$1_0=null;$1_4=this.$F($1_1);$1_3='POST';}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17($4,$1_2,$1_0,$1_3,$1_4,$1,$3,$2);}),$2,$1);return $0;},$E:function($p0){return $p0.length>2048;},$F:function($p0){return '--batch_boundary\r\nContent-Type: application/http\r\nContent-Transfer-Encoding: binary\r\n\r\nGET '+encodeURI($p0)+' HTTP/1.1\r\nContent-Type: application/json\r\nOData-Version: 4.0\r\nOData-MaxVersion: 4.0\r\n\r\n--batch_boundary--';},retrieve:function(entityName,entityId,attributesList){return this.beginRetrieveInternal(entityName,entityId,attributesList,null);},beginRetrieveInternal:function(entityName,entityId,attributesList,callBack){var $0=null;var $1=!ss.isNullOrUndefined(callBack);var $2=(!$1)?ss.Delegate.create(this,this.$12):callBack;var $3=(!$1)?ss.Delegate.create(this,function($p1_0){
$0=this.endRetrieve([$p1_0,entityName],SparkleXrm.Sdk.Entity);}):function($p1_0){
callBack([$p1_0,entityName]);};var $4=false;var $5=[];var $enum1=ss.IEnumerator.getEnumerator(attributesList);while($enum1.moveNext()){var $6=$enum1.current;var $7=$6;var $8=entityName+'.'+$6;if(Object.keyExists(SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$4,$8)){$7='_'+$6+'_value';}if(SparkleXrm.StringEx.IN($6,SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$2)){$4=true;$7=null;}if($7!=null){$5.add($7);}}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$13(entityName,ss.Delegate.create(this,function($p1_0){
var $1_0=[];if($5!=null&&$5.length>0){$1_0.add('$select='+$5.join(','));}if($4){$1_0.add('$expand=email_activity_parties($select=activitypartyid,_partyid_value,participationtypemask)');}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17($p1_0.logicalName,this.$11($p1_0,entityId),$1_0.join('&'),'GET',null,$1,$3,$2);}),$2,$1);return $0;},beginRetrieve:function(entityName,entityId,attributesList,callBack){this.beginRetrieveInternal(entityName,entityId,attributesList,callBack);},endRetrieve:function(asyncState,entityType){this.$8(asyncState);var $0=asyncState;var $1=new SparkleXrm.Sdk.Entity($0[1]);$1.deSerialiseWebApi(SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$10($0[0]));return $1;},$11:function($p0,$p1){$p1=$p1.replace(new RegExp('[{}]','g'),'');return $p0.entitySetName+'('+$p1+')';},associate:function(entityName,entityId,relationship,relatedEntities){this.beginAssociateInternal(entityName,true,entityId,relationship,relatedEntities,null);},beginAssociate:function(entityName,entityId,relationship,relatedEntities,callBack){this.beginAssociateInternal(entityName,true,entityId,relationship,relatedEntities,callBack);},beginAssociateInternal:function(entityName,isAssociate,entityId,relationship,relatedEntities,callBack){var $0=!ss.isNullOrUndefined(callBack);var $1=(!$0)?ss.Delegate.create(this,this.$12):callBack;var $2=(!$0)?ss.Delegate.create(this,function($p1_0){
this.endAssociate($p1_0);}):callBack;var $3=[];$3.add(entityName);var $enum1=ss.IEnumerator.getEnumerator(relatedEntities);while($enum1.moveNext()){var $4=$enum1.current;$3.add($4.logicalName);}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$14($3,ss.Delegate.create(this,function($p1_0){
SparkleXrm.DelegateItterator.callbackItterate(ss.Delegate.create(this,function($p2_0,$p2_1,$p2_2){
var $2_0=relatedEntities[$p2_0];SparkleXrm.Sdk.Attribute.$2(SparkleXrm.Sdk.EntityReference,$2_0,ss.Delegate.create(this,function($p3_0){
var $3_0=null;var $3_1=null;var $3_2=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1D()+$p3_0['@odata.id'];if(isAssociate){$p3_0['@odata.id']=$3_2;$3_1=JSON.stringify($p3_0);}else{$3_0='$id='+$3_2;}var $3_3=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$5[entityName];var $3_4=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$5[$2_0.logicalName];SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17(entityName,this.$11($3_3,entityId.value)+'/'+relationship.schemaName+'/$ref',$3_0,(isAssociate)?'POST':'DELETE',$3_1,false,$2,$1);}),$1,$0);}),relatedEntities.length,function(){
callBack(null);},function($p2_0){
$1($p2_0);});}),$1,$0);},endAssociate:function(asyncState){this.$8(asyncState);},disassociate:function(entityName,entityId,relationship,relatedEntities){this.beginAssociateInternal(entityName,false,entityId,relationship,relatedEntities,null);},beginDisassociate:function(entityName,entityId,relationship,relatedEntities,callBack){this.beginAssociateInternal(entityName,false,entityId,relationship,relatedEntities,callBack);},endDisassociate:function(asyncState){this.$8(asyncState);},$12:function($p0){if(Type.getInstanceType($p0)===Error){throw $p0;}else{throw new Error($p0);}},$16:function($p0){return $p0['value'];},endRetrieveMultiple:function(asyncState,entityType){this.$8(asyncState);var $0=asyncState;var $1=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1B($0);var $2=null;if(Object.keyExists($1,'batches')){var $3=$1;var $4=$3.batches[0];if($4.httpResponseCode===500||$4.httpResponseCode===400){var $5=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1A($4.response);throw $5;}$2=SparkleXrm.Sdk.EntityCollection.deserialiseWebApi(entityType,$0.logicalName,$4.response);}else{$2=SparkleXrm.Sdk.EntityCollection.deserialiseWebApi(entityType,$0.logicalName,$1);}return $2;}}
SparkleXrm.Sdk.XmlHelper=function(){}
SparkleXrm.Sdk.XmlHelper.encode=function(value){if(value==null){return value;}return value.replace(new RegExp("([\\&\"<>'])",'g'),SparkleXrm.Sdk.XmlHelper.replaceCallBackEncode);}
SparkleXrm.Sdk.XmlHelper.serialiseNode=function(node){if(typeof(node.xml)==='undefined'){return new XMLSerializer().serializeToString(node);}else{return node.xml;}}
SparkleXrm.Sdk.XmlHelper.Decode=function(value){if(value==null){return null;}return value.replace(new RegExp('(&quot;|&lt;|&gt;|&amp;|&#39;)','g'),SparkleXrm.Sdk.XmlHelper.replaceCallBackDecode);}
SparkleXrm.Sdk.XmlHelper.replaceCallBackEncode=function(item){return SparkleXrm.Sdk.XmlHelper._encode_map[item];}
SparkleXrm.Sdk.XmlHelper.replaceCallBackDecode=function(item){return SparkleXrm.Sdk.XmlHelper._decode_map[item];}
SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue=function(doc,baseName){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(doc,baseName);if($0!=null){return SparkleXrm.Sdk.XmlHelper.getNodeTextValue($0);}else{return null;}}
SparkleXrm.Sdk.XmlHelper.selectSingleNode=function(doc,baseName){var $enum1=ss.IEnumerator.getEnumerator(doc.childNodes);while($enum1.moveNext()){var $0=$enum1.current;if(SparkleXrm.Sdk.XmlHelper.getLocalName($0)===baseName){return $0;}}return null;}
SparkleXrm.Sdk.XmlHelper.getLocalName=function(node){if(node.baseName!=null){return node.baseName;}else{return node.localName;}}
SparkleXrm.Sdk.XmlHelper.selectSingleNodeValueDeep=function(doc,baseName){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep(doc,baseName);if($0!=null){return SparkleXrm.Sdk.XmlHelper.getNodeTextValue($0);}else{return null;}}
SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep=function(doc,baseName){var $enum1=ss.IEnumerator.getEnumerator(doc.childNodes);while($enum1.moveNext()){var $0=$enum1.current;if(SparkleXrm.Sdk.XmlHelper.getLocalName($0)===baseName){return $0;}var $1=SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep($0,baseName);if($1!=null){return $1;}}return null;}
SparkleXrm.Sdk.XmlHelper.nsResolver=function(prefix){switch(prefix){case 's':return 'http://schemas.xmlsoap.org/soap/envelope/';case 'a':return 'http://schemas.microsoft.com/xrm/2011/Contracts';case 'i':return 'http://www.w3.org/2001/XMLSchema-instance';case 'b':return 'http://schemas.datacontract.org/2004/07/System.Collections.Generic';case 'c':return 'http://schemas.microsoft.com/xrm/2011/Metadata';default:return null;}}
SparkleXrm.Sdk.XmlHelper.isSelectSingleNodeUndefined=function(value){return typeof (value.selectSingleNode)==='undefined';}
SparkleXrm.Sdk.XmlHelper.isXPathEvaluatorUndefined=function(){return typeof XPathEvaluator==='undefined';}
SparkleXrm.Sdk.XmlHelper.loadXml=function(xml){if(typeof (ActiveXObject)==='undefined'){var $0=new DOMParser();return $0.parseFromString(xml,'text/xml');}else{var $1=(new ActiveXObject('Msxml2.DOMDocument'));$1.async = false;$1.loadXML(xml);$1.setProperty('SelectionLanguage', 'XPath');return $1;}}
SparkleXrm.Sdk.XmlHelper.selectSingleNodeXpath=function(node,xpath){if(!SparkleXrm.Sdk.XmlHelper.isSelectSingleNodeUndefined(node)||SparkleXrm.Sdk.XmlHelper.isXPathEvaluatorUndefined()){return node.selectSingleNode(xpath);}else{var $0=new XPathEvaluator();var $1=$0.evaluate(xpath,node,SparkleXrm.Sdk.XmlHelper.nsResolver,9,null);return ($1!=null)?$1.singleNodeValue:null;}}
SparkleXrm.Sdk.XmlHelper.getNodeTextValue=function(node){if((node!=null)&&(node.firstChild!=null)){return node.firstChild.nodeValue;}else{return null;}}
SparkleXrm.Sdk.XmlHelper.getAttributeValue=function(node,attributeName){var $0=node.attributes.getNamedItem(attributeName);if($0!=null){return $0.nodeValue;}else{return null;}}
Type.registerNamespace('SparkleXrm.Sdk.Messages');Type.registerNamespace('Xrm.Sdk.Messages');Xrm.Sdk.Messages.OperationTypeEnum=function(){};Xrm.Sdk.Messages.OperationTypeEnum.prototype = {functionCall:'functionCall',action:'action'}
Xrm.Sdk.Messages.OperationTypeEnum.registerEnum('Xrm.Sdk.Messages.OperationTypeEnum',false);SparkleXrm.Sdk.Messages.EntityFilters=function(){};SparkleXrm.Sdk.Messages.EntityFilters.prototype = {default_:1,entity:1,attributes:2,privileges:4,relationships:8,all:15}
SparkleXrm.Sdk.Messages.EntityFilters.registerEnum('SparkleXrm.Sdk.Messages.EntityFilters',true);SparkleXrm.Sdk.Messages.AddToQueueRequest=function(){}
SparkleXrm.Sdk.Messages.AddToQueueRequest.prototype={DestinationQueueId:null,Target:null,serialise:function(){return '<d:request>'+'<a:Parameters>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>DestinationQueueId</b:key>'+((this.DestinationQueueId==null)?'<b:value i:nil="true" />':'<b:value i:type="e:guid">'+this.DestinationQueueId.toString()+'</b:value>')+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>Target</b:key>'+((this.Target==null)?'<b:value i:nil="true" />':SparkleXrm.Sdk.Attribute.serialiseValue(this.Target,null))+'</a:KeyValuePairOfstringanyType>'+'</a:Parameters>'+'<a:RequestId i:nil="true" />'+'<a:RequestName>AddToQueue</a:RequestName>'+'</d:request>';},serialiseWebApi:function(){var $0=new SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties();$0.OperationType='action';$0.BoundEntityId=this.DestinationQueueId;$0.BoundEntityLogicalName='queue';$0.RequestName='Microsoft.Dynamics.CRM.AddToQueue';var $1=new SparkleXrm.Sdk.Entity(this.Target.logicalName);$1.setAttributeValue('activityid',this.Target.id.value);$0.AdditionalProperties['Target']=$1;return $0;}}
SparkleXrm.Sdk.Messages.AddToQueueResponse=function(response){if(response==null){return;}var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='QueueItemId'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');this.QueueItemId=new SparkleXrm.Sdk.Guid(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($3));}}}
SparkleXrm.Sdk.Messages.AddToQueueResponse.prototype={QueueItemId:null,deserialiseWebApi:function(response){this.QueueItemId=new SparkleXrm.Sdk.Guid(response['QueueItemId']);}}
SparkleXrm.Sdk.Messages.AssignRequest=function(){}
SparkleXrm.Sdk.Messages.AssignRequest.prototype={Target:null,Assignee:null,serialise:function(){return '<request i:type="c:AssignRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:c="http://schemas.microsoft.com/crm/2011/Contracts">'+'        <a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'          <a:KeyValuePairOfstringanyType>'+'            <b:key>Target</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.Target,null)+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <b:key>Assignee</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.Assignee,null)+'          </a:KeyValuePairOfstringanyType>'+'        </a:Parameters>'+'        <a:RequestId i:nil="true" />'+'        <a:RequestName>Assign</a:RequestName>'+'      </request>';}}
SparkleXrm.Sdk.Messages.AssignResponse=function(response){}
SparkleXrm.Sdk.Messages.BulkDeleteRequest=function(){}
SparkleXrm.Sdk.Messages.BulkDeleteRequest.prototype={serialise:function(){var $0='';if(this.ToRecipients!=null){var $enum1=ss.IEnumerator.getEnumerator(this.ToRecipients);while($enum1.moveNext()){var $2=$enum1.current;$0+=('<d:guid>'+$2.toString()+'</d:guid>');}}var $1='';if(this.CCRecipients!=null){var $enum2=ss.IEnumerator.getEnumerator(this.CCRecipients);while($enum2.moveNext()){var $3=$enum2.current;$1+=('<d:guid>'+$3.toString()+'</d:guid>');}}return String.format('<request i:type="b:BulkDeleteRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts">'+'        <a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>QuerySet</c:key>'+'            <c:value i:type="a:ArrayOfQueryExpression">'+'              <a:QueryExpression>'+this.QuerySet+'              </a:QueryExpression>'+'            </c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>JobName</c:key>'+'            <c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+this.JobName+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>SendEmailNotification</c:key>'+'            <c:value i:type="d:boolean" xmlns:d="http://www.w3.org/2001/XMLSchema">'+this.SendEmailNotification.toString()+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>ToRecipients</c:key>'+'            <c:value i:type="d:ArrayOfguid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays">'+$0+'            </c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>CCRecipients</c:key>'+'            <c:value i:type="d:ArrayOfguid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays">'+$1+'            </c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>RecurrencePattern</c:key>'+'            <c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema" >'+this.RecurrencePattern+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>StartDateTime</c:key>'+'            <c:value i:type="d:dateTime" xmlns:d="http://www.w3.org/2001/XMLSchema">'+SparkleXrm.Sdk.DateTimeEx.toXrmStringUTC(SparkleXrm.Sdk.DateTimeEx.localTimeToUTCFromSettings(this.StartDateTime,SparkleXrm.Sdk.OrganizationServiceProxy.getUserSettings()))+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'        </a:Parameters>'+'        <a:RequestId i:nil="true" />'+'        <a:RequestName>BulkDelete</a:RequestName>'+'      </request>');},CCRecipients:null,JobName:null,QuerySet:null,RecurrencePattern:null,SendEmailNotification:false,SourceImportId:null,StartDateTime:null,ToRecipients:null}
SparkleXrm.Sdk.Messages.BulkDeleteResponse=function(response){}
SparkleXrm.Sdk.Messages.ExecuteWorkflowRequest=function(){}
SparkleXrm.Sdk.Messages.ExecuteWorkflowRequest.prototype={EntityId:null,WorkflowId:null,serialise:function(){return String.format('<request i:type="b:ExecuteWorkflowRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts">'+'        <a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>EntityId</c:key>'+'            <c:value i:type="e:guid" xmlns:e="http://schemas.microsoft.com/2003/10/Serialization/">'+this.EntityId+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>WorkflowId</c:key>'+'            <c:value i:type="e:guid" xmlns:e="http://schemas.microsoft.com/2003/10/Serialization/">'+this.WorkflowId+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'        </a:Parameters>'+'        <a:RequestId i:nil="true" />'+'        <a:RequestName>ExecuteWorkflow</a:RequestName>'+'      </request>');}}
SparkleXrm.Sdk.Messages.ExecuteWorkflowResponse=function(response){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='Id'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');this.Id=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($3);}}}
SparkleXrm.Sdk.Messages.ExecuteWorkflowResponse.prototype={Id:null}
SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionRequest=function(){}
SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionRequest.prototype={FetchXml:null,serialise:function(){var $0='';$0+='      <request i:type="b:FetchXmlToQueryExpressionRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts">';$0+='        <a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">';$0+='          <a:KeyValuePairOfstringanyType>';$0+='            <c:key>FetchXml</c:key>';$0+='            <c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">{0}</c:value>';$0+='          </a:KeyValuePairOfstringanyType>';$0+='        </a:Parameters>';$0+='        <a:RequestId i:nil="true" />';$0+='        <a:RequestName>FetchXmlToQueryExpression</a:RequestName>';$0+='      </request>';return String.format($0,SparkleXrm.Sdk.XmlHelper.encode(this.FetchXml));}}
SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionResponse=function(response){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='Query'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');var $4=SparkleXrm.Sdk.XmlHelper.serialiseNode($3).substr(165);$4=$4.substr(0,$4.length-10);this.Query=$4;}}}
SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionResponse.prototype={Query:null}
SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties=function(){this.AdditionalProperties={};}
SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties.prototype={BoundEntityLogicalName:null,BoundEntityId:null,RequestName:null,OperationType:null,CustomImplementation:null}
SparkleXrm.Sdk.Messages.RetrieveAllEntitiesRequest=function(){}
SparkleXrm.Sdk.Messages.RetrieveAllEntitiesRequest.prototype={serialise:function(){return '\r\n                              <request i:type="a:RetrieveAllEntitiesRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">\r\n                                <a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">\r\n                                  <a:KeyValuePairOfstringanyType>\r\n                                    <b:key>EntityFilters</b:key>\r\n                                    <b:value i:type="c:EntityFilters" xmlns:c="http://schemas.microsoft.com/xrm/2011/Metadata">Entity</b:value>\r\n                                  </a:KeyValuePairOfstringanyType>\r\n                                  <a:KeyValuePairOfstringanyType>\r\n                                    <b:key>RetrieveAsIfPublished</b:key>\r\n                                    <b:value i:type="c:boolean" xmlns:c="http://www.w3.org/2001/XMLSchema">true</b:value>\r\n                                  </a:KeyValuePairOfstringanyType>\r\n                                </a:Parameters>\r\n                                <a:RequestId i:nil="true" />\r\n                                <a:RequestName>RetrieveAllEntities</a:RequestName>\r\n                              </request>\r\n                            ';}}
SparkleXrm.Sdk.Messages.RetrieveAllEntitiesResponse=function(response){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='EntityMetadata'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');this.EntityMetadata=new Array($3.childNodes.length);for(var $4=0;$4<$3.childNodes.length;$4++){var $5=$3.childNodes[$4];var $6=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseEntityMetadata({},$5);this.EntityMetadata[$4]=$6;}}}}
SparkleXrm.Sdk.Messages.RetrieveAllEntitiesResponse.prototype={EntityMetadata:null}
SparkleXrm.Sdk.Messages.RetrieveAttributeRequest=function(){}
SparkleXrm.Sdk.Messages.RetrieveAttributeRequest.prototype={EntityLogicalName:null,LogicalName:null,RetrieveAsIfPublished:false,serialise:function(){return String.format('<request i:type="a:RetrieveAttributeRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">'+'<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'<a:KeyValuePairOfstringanyType>'+'<b:key>EntityLogicalName</b:key>'+'<b:value i:type="c:string" xmlns:c="http://www.w3.org/2001/XMLSchema">{0}</b:value>'+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>MetadataId</b:key>'+'<b:value i:type="ser:guid"  xmlns:ser="http://schemas.microsoft.com/2003/10/Serialization/">00000000-0000-0000-0000-000000000000</b:value>'+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>RetrieveAsIfPublished</b:key>'+'<b:value i:type="c:boolean" xmlns:c="http://www.w3.org/2001/XMLSchema">{2}</b:value>'+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>LogicalName</b:key>'+'<b:value i:type="c:string" xmlns:c="http://www.w3.org/2001/XMLSchema">{1}</b:value>'+'</a:KeyValuePairOfstringanyType>'+'</a:Parameters>'+'<a:RequestId i:nil="true" />'+'<a:RequestName>RetrieveAttribute</a:RequestName>'+'</request>',this.EntityLogicalName,this.LogicalName,this.RetrieveAsIfPublished);},serialiseWebApi:function(){var $0=new SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties();$0.CustomImplementation=ss.Delegate.create(this,this.$0);return $0;},$0:function($p0,$p1,$p2,$p3){var $0=$p0;var $1=String.format("$select=LogicalName&$filter=LogicalName eq '{0}'&$expand=Attributes($filter=LogicalName eq '{1}')",$0.EntityLogicalName,$0.LogicalName);var $2=[];SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17('EntityDefinition','EntityDefinitions',$1,'GET',null,$p3,function($p1_0){
var $1_0=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$10($p1_0);var $1_1=$1_0['value'];var $1_2=new SparkleXrm.Sdk.Messages.RetrieveAttributeResponse(null);var $1_3=($1_1[0]);$1_2.AttributeMetadata=$1_3.Attributes[0];if($1_2.AttributeMetadata.AttributeType==='Picklist'){var $1_4=String.format('EntityDefinitions({0})/Attributes({1})/Microsoft.Dynamics.CRM.PicklistAttributeMetadata/OptionSet',$1_3.MetadataId,$1_2.AttributeMetadata.MetadataId);SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17('Attribute',$1_4,'$select=Options','GET',null,$p3,function($p2_0){
var $2_0=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$10($p2_0);var $2_1=$1_2.AttributeMetadata;$2_1.OptionSet=$2_0;$p1($1_2);},$p2);}else{$p1($1_2);}},$p2);}}
SparkleXrm.Sdk.Messages.RetrieveAttributeResponse=function(response){if(response==null){return;}var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $1=SparkleXrm.Sdk.XmlHelper.selectSingleNode($0.firstChild,'value');var $2=SparkleXrm.Sdk.XmlHelper.getAttributeValue($1,'i:type');switch($2){case 'c:PicklistAttributeMetadata':this.AttributeMetadata=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialisePicklistAttributeMetadata({},$1);break;}}
SparkleXrm.Sdk.Messages.RetrieveAttributeResponse.prototype={AttributeMetadata:null}
Xrm.Sdk.Messages.RetrieveDuplicatesRequest=function(){}
Xrm.Sdk.Messages.RetrieveDuplicatesRequest.prototype={BusinessEntity:null,MatchingEntityName:null,PagingInfo:null,serialise:function(){return '<d:request>'+'<a:Parameters>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>BusinessEntity</b:key>'+((this.BusinessEntity==null)?'<b:value i:nil="true" />':'<b:value i:type="a:Entity">'+this.BusinessEntity.serialise(true)+'</b:value>')+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>MatchingEntityName</b:key>'+((this.MatchingEntityName==null)?'<b:value i:nil="true" />':'<b:value i:type="c:string">'+this.MatchingEntityName+'</b:value>')+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>PagingInfo</b:key>'+((this.PagingInfo==null)?'<b:value i:nil="true" />':'<b:value i:type="a:PagingInfo">'+this.PagingInfo.serialise()+'</b:value>')+'</a:KeyValuePairOfstringanyType>'+'</a:Parameters>'+'<a:RequestId i:nil="true" />'+'<a:RequestName>RetrieveDuplicates</a:RequestName>'+'</d:request>';},serialiseWebApi:function(){var $0=new SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties();$0.OperationType='functionCall';$0.RequestName='RetrieveDuplicates';if(this.BusinessEntity.id!=null){$0.AdditionalProperties['BusinessEntity']=this.BusinessEntity.toEntityReference();}else{$0.AdditionalProperties['BusinessEntity']=this.BusinessEntity;}$0.AdditionalProperties['MatchingEntityName']=this.MatchingEntityName;$0.AdditionalProperties['PagingInfo']=this.PagingInfo;return $0;}}
Xrm.Sdk.Messages.RetrieveDuplicatesResponse=function(response){if(response==null){return;}var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='DuplicateCollection'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');this.DuplicateCollection=SparkleXrm.Sdk.EntityCollection.deSerialise($3);}}}
Xrm.Sdk.Messages.RetrieveDuplicatesResponse.prototype={DuplicateCollection:null,deserialiseWebApi:function(response){this.DuplicateCollection=SparkleXrm.Sdk.EntityCollection.deserialiseWebApi(SparkleXrm.Sdk.Entity,null,response);}}
SparkleXrm.Sdk.Messages.RetrieveEntityRequest=function(){}
SparkleXrm.Sdk.Messages.RetrieveEntityRequest.prototype={EntityFilters:0,LogicalName:null,MetadataId:null,RetrieveAsIfPublished:false,serialise:function(){return '<request i:type="a:RetrieveEntityRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">'+'<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'<a:KeyValuePairOfstringanyType>'+'<b:key>EntityFilters</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.EntityFilters,'EntityFilters')+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>MetadataId</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.MetadataId,null)+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>RetrieveAsIfPublished</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.RetrieveAsIfPublished,null)+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>LogicalName</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.LogicalName,null)+'</a:KeyValuePairOfstringanyType>'+'</a:Parameters>'+'<a:RequestId i:nil="true" />'+'<a:RequestName>RetrieveEntity</a:RequestName>'+'</request>';},serialiseWebApi:function(){var $0=new SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties();$0.CustomImplementation=ss.Delegate.create(this,this.$0);return $0;},$0:function($p0,$p1,$p2,$p3){var $0=$p0;var $1='ActivityTypeMask,AutoRouteToOwnerQueue,CanTriggerWorkflow,Description,DisplayCollectionName,EntityHelpUrlEnabled,EntityHelpUrl,IsDocumentManagementEnabled,IsOneNoteIntegrationEnabled,IsSLAEnabled,IsBPFEntity,IsActivity,IsActivityParty,IsAuditEnabled,IsAvailableOffline,IsChildEntity,IsValidForQueue,IsConnectionsEnabled,IconLargeName,IconMediumName,IconSmallName,IsCustomEntity,IsBusinessProcessEnabled,IsCustomizable,IsDuplicateDetectionEnabled,IsIntersect,IsValidForAdvancedFind,LogicalName,ObjectTypeCode,OwnershipType,PrimaryNameAttribute,PrimaryImageAttribute,PrimaryIdAttribute,SchemaName,EntityColor,LogicalCollectionName,CollectionSchemaName,EntitySetName,MetadataId,HasChanged';var $2=String.format("$filter=LogicalName eq '{0}'",$0.LogicalName);var $3=[];if(($0.EntityFilters&2)===4){$1+=',Privileges';}if(($0.EntityFilters&2)===2){$3.add('Attributes($select=AttributeOf,AttributeType,AttributeTypeName,DisplayName,LogicalName,RequiredLevel,SchemaName)');}if(($0.EntityFilters&8)===8){$3.add('ManyToManyRelationships');$3.add('ManyToOneRelationships');$3.add('OneToManyRelationships');}if($3.length>0){$2+='&$expand='+$3.join(',');}SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$17('EntityDefinition','EntityDefinitions',$2,'GET',null,$p3,function($p1_0){
var $1_0=SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$10($p1_0);var $1_1=$1_0['value'];var $1_2=new SparkleXrm.Sdk.Messages.RetrieveEntityResponse(null);$1_2.EntityMetadata=$1_1[0];$p1($1_2);},$p2);}}
SparkleXrm.Sdk.Messages.RetrieveEntityResponse=function(response){if(response==null){return;}var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='EntityMetadata'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');this.EntityMetadata=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseEntityMetadata({},$3);}}}
SparkleXrm.Sdk.Messages.RetrieveEntityResponse.prototype={EntityMetadata:null}
SparkleXrm.Sdk.Messages.RetrieveMetadataChangesRequest=function(){}
SparkleXrm.Sdk.Messages.RetrieveMetadataChangesRequest.prototype={clientVersionStamp:null,deletedMetadataFilters:null,query:null,serialise:function(){return "<request i:type='a:RetrieveMetadataChangesRequest' xmlns:a='http://schemas.microsoft.com/xrm/2011/Contracts'>\r\n                <a:Parameters xmlns:b='http://schemas.datacontract.org/2004/07/System.Collections.Generic'>\r\n                  <a:KeyValuePairOfstringanyType>\r\n                    <b:key>ClientVersionStamp</b:key>"+SparkleXrm.Sdk.Attribute.serialiseValue(this.clientVersionStamp,null)+'\r\n                  </a:KeyValuePairOfstringanyType>\r\n                  <a:KeyValuePairOfstringanyType>\r\n                    <b:key>Query</b:key>\r\n                    '+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseEntityQueryExpression(this.query)+"\r\n                  </a:KeyValuePairOfstringanyType>\r\n                </a:Parameters>\r\n                <a:RequestId i:nil='true' />\r\n                <a:RequestName>RetrieveMetadataChanges</a:RequestName>\r\n              </request>";},serialiseWebApi:function(){var $0=new SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties();$0.OperationType='functionCall';$0.RequestName='RetrieveMetadataChanges';this.$0(this.query.Criteria);if(this.query.AttributeQuery!=null){this.$0(this.query.AttributeQuery.Criteria);}if(this.query.RelationshipQuery!=null){this.$0(this.query.RelationshipQuery.Criteria);}$0.AdditionalProperties['Query']=this.query;return $0;},$0:function($p0){if($p0!=null&&$p0.Conditions!=null){var $enum1=ss.IEnumerator.getEnumerator($p0.Conditions);while($enum1.moveNext()){var $0=$enum1.current;if(ss.isUndefined(($0.Value).Type)){var $1={};$1.Value=$0.Value;$1.Type='System.String';$0.Value=$1;}}if($p0.Filters!=null){var $enum2=ss.IEnumerator.getEnumerator($p0.Filters);while($enum2.moveNext()){var $2=$enum2.current;this.$0($2);}}}}}
SparkleXrm.Sdk.Messages.RetrieveMetadataChangesResponse=function(response){if(response==null){return;}var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');switch(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)){case 'ServerVersionStamp':this.ServerVersionStamp=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($3);break;case 'DeletedMetadata':break;case 'EntityMetadata':this.EntityMetadata=[];for(var $4=0;$4<$3.childNodes.length;$4++){var $5=$3.childNodes[$4];var $6=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseEntityMetadata({},$5);this.EntityMetadata.add($6);}break;}}}
SparkleXrm.Sdk.Messages.RetrieveMetadataChangesResponse.prototype={EntityMetadata:null,ServerVersionStamp:null,deserialiseWebApi:function(response){this.EntityMetadata=response['EntityMetadata'];this.ServerVersionStamp=response['ServerVersionStamp'];}}
SparkleXrm.Sdk.Messages.RetrieveUserPrivilegesRequest=function(){}
SparkleXrm.Sdk.Messages.RetrieveUserPrivilegesRequest.prototype={UserId:null,serialise:function(){return String.format('<request i:type="b:ExecuteWorkflowRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts">'+'        <a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>UserId</c:key>'+'            <c:value i:type="e:guid" xmlns:e="http://schemas.microsoft.com/2003/10/Serialization/">'+this.UserId.value+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'        </a:Parameters>'+'        <a:RequestId i:nil="true" />'+'        <a:RequestName>RetrieveUserPrivileges</a:RequestName>'+'      </request>');},serialiseWebApi:function(){var $0=new SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties();$0.OperationType='functionCall';$0.RequestName='Microsoft.Dynamics.CRM.RetrieveUserPrivileges';$0.BoundEntityId=this.UserId;$0.BoundEntityLogicalName='systemuser';return $0;}}
Xrm.Sdk.Messages.RolePrivilege=function(){}
Xrm.Sdk.Messages.RolePrivilege.prototype={BusinessUnitId:null,Depth:null,PrivilegeId:null}
SparkleXrm.Sdk.Messages.RetrieveUserPrivilegesResponse=function(response){if(response==null){return;}var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='RolePrivileges'){this.RolePrivileges=[];var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');var $enum2=ss.IEnumerator.getEnumerator($3.childNodes);while($enum2.moveNext()){var $4=$enum2.current;var $5=new Xrm.Sdk.Messages.RolePrivilege();var $enum3=ss.IEnumerator.getEnumerator($4.childNodes);while($enum3.moveNext()){var $6=$enum3.current;var $7=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($6);switch(SparkleXrm.Sdk.XmlHelper.getLocalName($6)){case 'BusinessUnitId':$5.BusinessUnitId=new SparkleXrm.Sdk.Guid($7);break;case 'Depth':$5.Depth=$7;break;case 'PrivilegeId':$5.PrivilegeId=new SparkleXrm.Sdk.Guid($7);break;}}this.RolePrivileges.add($5);}}}}
SparkleXrm.Sdk.Messages.RetrieveUserPrivilegesResponse.prototype={RolePrivileges:null,deserialiseWebApi:function(response){this.RolePrivileges=response['RolePrivileges'];var $enum1=ss.IEnumerator.getEnumerator(this.RolePrivileges);while($enum1.moveNext()){var $0=$enum1.current;$0.BusinessUnitId=new SparkleXrm.Sdk.Guid($0.BusinessUnitId.toString());$0.PrivilegeId=new SparkleXrm.Sdk.Guid($0.PrivilegeId.toString());}}}
SparkleXrm.Sdk.Messages.WhoAmIRequest=function(){}
SparkleXrm.Sdk.Messages.WhoAmIRequest.prototype={serialise:function(){return String.format('<request i:type="b:WhoAmIRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts">'+'        <a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'        </a:Parameters>'+'        <a:RequestId i:nil="true" />'+'        <a:RequestName>WhoAmI</a:RequestName>'+'      </request>');},serialiseWebApi:function(){var $0=new SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties();$0.OperationType='functionCall';$0.RequestName='WhoAmI';return $0;}}
SparkleXrm.Sdk.Messages.WhoAmIResponse=function(response){if(response==null){return;}var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');var $3=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2);var $4=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');var $5=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($4);switch($3){case 'OrganizationId':this.OrganizationId=new SparkleXrm.Sdk.Guid($5);break;case 'UserId':this.UserId=new SparkleXrm.Sdk.Guid($5);break;}}}
SparkleXrm.Sdk.Messages.WhoAmIResponse.prototype={OrganizationId:null,UserId:null,deserialiseWebApi:function(response){this.OrganizationId=new SparkleXrm.Sdk.Guid(response['OrganizationId']);this.UserId=new SparkleXrm.Sdk.Guid(response['UserId']);}}
SparkleXrm.Sdk.Messages.WinOpportunityRequest=function(){}
SparkleXrm.Sdk.Messages.WinOpportunityRequest.prototype={OpportunityClose:null,Status:null,serialise:function(){return '<d:request>'+'<a:Parameters>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>OpportunityClose</b:key>'+((this.OpportunityClose==null)?'<b:value i:nil="true" />':'<b:value i:type="a:Entity">'+this.OpportunityClose.serialise(true)+'</b:value>')+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>Status</b:key>'+((this.Status==null)?'<b:value i:nil="true" />':'<b:value i:type="a:OptionSetValue"><a:Value>'+this.Status.value.toString()+'</a:Value></b:value>')+'</a:KeyValuePairOfstringanyType>'+'</a:Parameters>'+'<a:RequestId i:nil="true" />'+'<a:RequestName>WinOpportunity</a:RequestName>'+'</d:request>';},serialiseWebApi:function(){var $0=new SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties();$0.OperationType='action';$0.RequestName='WinOpportunity';$0.AdditionalProperties['OpportunityClose']=this.OpportunityClose;$0.AdditionalProperties['Status']=this.Status;return $0;}}
SparkleXrm.Sdk.Messages.WinOpportunityResponse=function(){}
SparkleXrm.Sdk.Messages.WinOpportunityResponse.prototype={deserialiseWebApi:function(response){}}
SparkleXrm.Sdk.Messages.PagingInfo=function(){}
SparkleXrm.Sdk.Messages.PagingInfo.prototype={Count:0,PageNumber:0,PagingCookie:null,ReturnTotalRecordCount:false,serialise:function(){return '<a:Count>'+this.Count.toString()+'</a:Count>'+'<a:PageNumber>'+this.PageNumber.toString()+'</a:PageNumber>'+'<a:PageNumber>'+this.ReturnTotalRecordCount.toString()+'</a:PageNumber>';}}
Type.registerNamespace('SparkleXrm.Sdk.Metadata.Query');SparkleXrm.Sdk.Metadata.Query.DeletedMetadataFilters=function(){};SparkleXrm.Sdk.Metadata.Query.DeletedMetadataFilters.prototype = {Default:'Default',Entity:'Entity',Attribute:'Attribute',Relationship:'Relationship',Label:'Label',OptionSet:'OptionSet',All:'All'}
SparkleXrm.Sdk.Metadata.Query.DeletedMetadataFilters.registerEnum('SparkleXrm.Sdk.Metadata.Query.DeletedMetadataFilters',false);SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser=function(){}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseAttributeMetadata=function(item,attribute){var $enum1=ss.IEnumerator.getEnumerator(attribute.childNodes);while($enum1.moveNext()){var $0=$enum1.current;var $1=item;var $2=SparkleXrm.Sdk.XmlHelper.getLocalName($0);var $3=$2;if($0.attributes.length===1&&$0.attributes[0].nodeName==='i:nil'){continue;}switch($2){case 'AttributeOf':case 'DeprecatedVersion':case 'EntityLogicalName':case 'LogicalName':case 'SchemaName':case 'CalculationOf':$1[$3]=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($0);break;case 'CanBeSecuredForCreate':case 'CanBeSecuredForRead':case 'CanBeSecuredForUpdate':case 'CanModifyAdditionalSettings':case 'IsAuditEnabled':case 'IsCustomAttribute':case 'IsCustomizable':case 'IsManaged':case 'IsPrimaryId':case 'IsPrimaryName':case 'IsRenameable':case 'IsSecured':case 'IsValidForAdvancedFind':case 'IsValidForCreate':case 'IsValidForRead':case 'IsValidForUpdate':case 'DefaultValue':$1[$3]=SparkleXrm.Sdk.Attribute.deSerialise($0,'boolean');break;case 'ColumnNumber':case 'Precision':case 'DefaultFormValue':case 'MaxLength':case 'PrecisionSource':$1[$3]=SparkleXrm.Sdk.Attribute.deSerialise($0,'int');break;case 'Description':case 'DisplayName':var $4={};$1[$3]=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLabel($4,$0);break;case 'OptionSet':var $5={};$1[$3]=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseOptionSetMetadata($5,$0);break;case 'AttributeType':item.AttributeType=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($0);break;}}return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseEntityMetadata=function(item,entity){var $enum1=ss.IEnumerator.getEnumerator(entity.childNodes);while($enum1.moveNext()){var $0=$enum1.current;var $1=item;var $2=SparkleXrm.Sdk.XmlHelper.getLocalName($0);var $3=$2;if($0.attributes.length===1&&$0.attributes[0].nodeName==='i:nil'){continue;}switch($2){case 'IconLargeName':case 'IconMediumName':case 'IconSmallName':case 'LogicalName':case 'PrimaryIdAttribute':case 'PrimaryNameAttribute':case 'RecurrenceBaseEntityLogicalName':case 'ReportViewName':case 'SchemaName':case 'PrimaryImageAttribute':$1[$3]=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($0);break;case 'AutoRouteToOwnerQueue':case 'CanBeInManyToMany':case 'CanBePrimaryEntityInRelationship':case 'CanBeRelatedEntityInRelationship':case 'CanCreateAttributes':case 'CanCreateCharts':case 'CanCreateForms':case 'CanCreateViews':case 'CanModifyAdditionalSettings':case 'CanTriggerWorkflow':case 'IsActivity':case 'IsActivityParty':case 'IsAuditEnabled':case 'IsAvailableOffline':case 'IsChildEntity':case 'IsConnectionsEnabled':case 'IsCustomEntity':case 'IsCustomizable':case 'IsDocumentManagementEnabled':case 'IsDuplicateDetectionEnabled':case 'IsEnabledForCharts':case 'IsImportable':case 'IsIntersect':case 'IsMailMergeEnabled':case 'IsManaged':case 'IsReadingPaneEnabled':case 'IsRenameable':case 'IsValidForAdvancedFind':case 'IsValidForQueue':case 'IsVisibleInMobile':$1[$3]=SparkleXrm.Sdk.Attribute.deSerialise($0,'boolean');break;case 'ActivityTypeMask':case 'ObjectTypeCode':$1[$3]=SparkleXrm.Sdk.Attribute.deSerialise($0,'int');break;case 'Attributes':item.Attributes=[];var $enum2=ss.IEnumerator.getEnumerator($0.childNodes);while($enum2.moveNext()){var $5=$enum2.current;var $6={};item.Attributes.add(SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseAttributeMetadata($6,$5));}break;case 'Description':case 'DisplayCollectionName':case 'DisplayName':var $4={};$1[$3]=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLabel($4,$0);break;}}return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLabel=function(item,metaData){item.LocalizedLabels=[];var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(metaData,'LocalizedLabels');if($0!=null&&$0.childNodes!=null){var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;item.LocalizedLabels.add(SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLocalizedLabel({},$1));}item.UserLocalizedLabel=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLocalizedLabel({},SparkleXrm.Sdk.XmlHelper.selectSingleNode(metaData,'UserLocalizedLabel'));}return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLocalizedLabel=function(item,metaData){item.Label=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(metaData,'Label');item.LanguageCode=parseInt(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(metaData,'LanguageCode'));return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseAttributeQueryExpression=function(item){return SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataQueryExpression(item);}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseEntityQueryExpression=function(item){if(item!=null){var $0="<b:value i:type='c:EntityQueryExpression' xmlns:c='http://schemas.microsoft.com/xrm/2011/Metadata/Query'>"+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataQueryExpression(item);if(item.AttributeQuery!=null){$0+='<c:AttributeQuery>'+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseAttributeQueryExpression(item.AttributeQuery)+'</c:AttributeQuery>';}$0+='<c:LabelQuery>'+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseLabelQueryExpression(item.LabelQuery)+"</c:LabelQuery>\r\n                <c:RelationshipQuery i:nil='true' />\r\n                </b:value>";return $0;}else{return "<b:value i:nil='true'/>";}}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseLabelQueryExpression=function(item){if(item!=null){var $0="<c:FilterLanguages xmlns:d='http://schemas.microsoft.com/2003/10/Serialization/Arrays'>";var $enum1=ss.IEnumerator.getEnumerator(item.FilterLanguages);while($enum1.moveNext()){var $1=$enum1.current;$0=$0+'<d:int>'+$1.toString()+'</d:int>';}$0=$0+'</c:FilterLanguages>';return $0;}else{return '';}}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataConditionExpression=function(item){return '<c:MetadataConditionExpression>\r\n                            <c:ConditionOperator>'+item.ConditionOperator+'</c:ConditionOperator>\r\n                            <c:PropertyName>'+item.PropertyName+"</c:PropertyName>\r\n                            <c:Value i:type='d:string' xmlns:d='http://www.w3.org/2001/XMLSchema'>"+item.Value+'</c:Value>\r\n                          </c:MetadataConditionExpression>';}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataFilterExpression=function(item){if(item!=null){var $0='<c:Conditions>';var $enum1=ss.IEnumerator.getEnumerator(item.Conditions);while($enum1.moveNext()){var $1=$enum1.current;$0+=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataConditionExpression($1);}$0=$0+'</c:Conditions>\r\n                        <c:FilterOperator>'+item.FilterOperator+'</c:FilterOperator>\r\n                        <c:Filters />';return $0;}return '';}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataPropertiesExpression=function(item){if(item!=null){var $0='\r\n                <c:AllProperties>'+((item.AllProperties!=null)?item.AllProperties.toString().toLowerCase():'false')+"</c:AllProperties>\r\n                <c:PropertyNames xmlns:d='http://schemas.microsoft.com/2003/10/Serialization/Arrays'>";if(item.PropertyNames!=null){var $enum1=ss.IEnumerator.getEnumerator(item.PropertyNames);while($enum1.moveNext()){var $1=$enum1.current;$0=$0+'<d:string>'+$1+'</d:string>';}}$0=$0+'\r\n                </c:PropertyNames>\r\n              ';return $0;}return '';}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataQueryExpression=function(item){if(item!=null){var $0='<c:Criteria>'+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataFilterExpression(item.Criteria)+'</c:Criteria>\r\n                    <c:Properties>'+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataPropertiesExpression(item.Properties)+' </c:Properties>';return $0;}return '';}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseRelationshipMetadata=function(attribute){var $0;var $1=SparkleXrm.Sdk.XmlHelper.getAttributeValue(attribute,'i:type');switch($1){case 'c:OneToManyRelationshipMetadata':$0={};break;case 'c:ManyToManyRelationshipMetadata':$0={};break;default:throw new Error('Unknown relationship type');}var $enum1=ss.IEnumerator.getEnumerator(attribute.childNodes);while($enum1.moveNext()){var $2=$enum1.current;var $3=$0;var $4=SparkleXrm.Sdk.XmlHelper.getLocalName($2);var $5=$4;if($2.attributes.length===1&&$2.attributes[0].nodeName==='i:nil'){continue;}switch($4){case 'SchemaName':case 'ReferencedAttribute':case 'ReferencedEntity':case 'ReferencingAttribute':case 'ReferencingEntity':case 'Entity1IntersectAttribute':case 'Entity1LogicalName':case 'Entity2IntersectAttribute':case 'Entity2LogicalName':case 'IntersectEntityName':$3[$5]=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2);break;case 'IsCustomRelationship':case 'IsManaged':case 'IsValidForAdvancedFind':$3[$5]=SparkleXrm.Sdk.Attribute.deSerialise($2,'boolean');break;case 'RelationshipType':$3[$5]=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2);break;}}return $0;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseOptionMetadata=function(item,metaData){item.Value=parseInt(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(metaData,'Value'));item.Label=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLabel({},SparkleXrm.Sdk.XmlHelper.selectSingleNode(metaData,'Label'));return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseOptionSetMetadata=function(item,metaData){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(metaData,'Options');if($0!=null){item.Options=[];var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;item.Options.add(SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseOptionMetadata({},$1));}}return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialisePicklistAttributeMetadata=function(item,metaData){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(metaData,'OptionSet');if($0!=null){item.OptionSet=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseOptionSetMetadata({},$0);}return item;}
Type.registerNamespace('SparkleXrm.Sdk.Metadata');SparkleXrm.Sdk.Metadata.AttributeRequiredLevel=function(){};SparkleXrm.Sdk.Metadata.AttributeRequiredLevel.prototype = {None:'None',SystemRequired:'SystemRequired',ApplicationRequired:'ApplicationRequired',Recommended:'Recommended'}
SparkleXrm.Sdk.Metadata.AttributeRequiredLevel.registerEnum('SparkleXrm.Sdk.Metadata.AttributeRequiredLevel',false);SparkleXrm.Sdk.Metadata.AttributeTypeCode=function(){};SparkleXrm.Sdk.Metadata.AttributeTypeCode.prototype = {Boolean:'Boolean',Customer:'Customer',DateTime:'DateTime',Decimal:'Decimal',Double:'Double',Integer:'Integer',Lookup:'Lookup',Memo:'Memo',Money:'Money',Owner:'Owner',PartyList:'PartyList',Picklist:'Picklist',State:'State',Status:'Status',String:'String',Uniqueidentifier:'Uniqueidentifier',CalendarRules:'CalendarRules',Virtual:'Virtual',BigInt:'BigInt',ManagedProperty:'ManagedProperty',EntityName:'EntityName'}
SparkleXrm.Sdk.Metadata.AttributeTypeCode.registerEnum('SparkleXrm.Sdk.Metadata.AttributeTypeCode',false);SparkleXrm.Sdk.Metadata.DateTimeFormat=function(){};SparkleXrm.Sdk.Metadata.DateTimeFormat.prototype = {DateOnly:'DateOnly',DateAndTime:'DateAndTime'}
SparkleXrm.Sdk.Metadata.DateTimeFormat.registerEnum('SparkleXrm.Sdk.Metadata.DateTimeFormat',false);SparkleXrm.Sdk.Metadata.IntegerFormat=function(){};SparkleXrm.Sdk.Metadata.IntegerFormat.prototype = {None:'None',Duration:'Duration',TimeZone:'TimeZone',Language:'Language',Locale:'Locale'}
SparkleXrm.Sdk.Metadata.IntegerFormat.registerEnum('SparkleXrm.Sdk.Metadata.IntegerFormat',false);SparkleXrm.Sdk.Metadata.OptionSetType=function(){};SparkleXrm.Sdk.Metadata.OptionSetType.prototype = {Picklist:'Picklist',State:'State',Status:'Status',Boolean:'Boolean'}
SparkleXrm.Sdk.Metadata.OptionSetType.registerEnum('SparkleXrm.Sdk.Metadata.OptionSetType',false);SparkleXrm.Sdk.Metadata.RelationshipType=function(){};SparkleXrm.Sdk.Metadata.RelationshipType.prototype = {OneToManyRelationship:'OneToManyRelationship',Default:'Default',ManyToManyRelationship:'ManyToManyRelationship'}
SparkleXrm.Sdk.Metadata.RelationshipType.registerEnum('SparkleXrm.Sdk.Metadata.RelationshipType',false);SparkleXrm.Sdk.Metadata.StringFormat=function(){};SparkleXrm.Sdk.Metadata.StringFormat.prototype = {Email:'Email',Text:'Text',TextArea:'TextArea',Url:'Url',TickerSymbol:'TickerSymbol',PhoneticGuide:'PhoneticGuide',VersionNumber:'VersionNumber',Phone:'Phone'}
SparkleXrm.Sdk.Metadata.StringFormat.registerEnum('SparkleXrm.Sdk.Metadata.StringFormat',false);SparkleXrm.Sdk.Metadata.MetadataCache=function(){}
SparkleXrm.Sdk.Metadata.MetadataCache.get_entityMetaData=function(){return SparkleXrm.Sdk.Metadata.MetadataCache.$1;}
SparkleXrm.Sdk.Metadata.MetadataCache.get_attributeMetaData=function(){return SparkleXrm.Sdk.Metadata.MetadataCache.$0;}
SparkleXrm.Sdk.Metadata.MetadataCache.get_optionsetMetaData=function(){return SparkleXrm.Sdk.Metadata.MetadataCache.$2;}
SparkleXrm.Sdk.Metadata.MetadataCache.getOptionSetValues=function(entityLogicalName,attributeLogicalName,allowEmpty){if(allowEmpty==null){allowEmpty=false;}var $0=entityLogicalName+'.'+attributeLogicalName+'.'+allowEmpty.toString();if(Object.keyExists(SparkleXrm.Sdk.Metadata.MetadataCache.$2,$0)){return SparkleXrm.Sdk.Metadata.MetadataCache.$2[$0];}else{var $1=SparkleXrm.Sdk.Metadata.MetadataCache.$4(entityLogicalName,attributeLogicalName);var $2=$1;var $3=[];if(allowEmpty){$3.add({});}var $enum1=ss.IEnumerator.getEnumerator($2.OptionSet.Options);while($enum1.moveNext()){var $4=$enum1.current;var $5={};$5.name=$4.Label.UserLocalizedLabel.Label;$5.value=$4.Value;$3.add($5);}SparkleXrm.Sdk.Metadata.MetadataCache.$2[$0]=$3;return $3;}}
SparkleXrm.Sdk.Metadata.MetadataCache.getEntityTypeCodeFromName=function(typeName){var $0=SparkleXrm.Sdk.Metadata.MetadataCache.$3(typeName);return $0.ObjectTypeCode;}
SparkleXrm.Sdk.Metadata.MetadataCache.getSmallIconUrl=function(typeName){var $0=SparkleXrm.Sdk.Metadata.MetadataCache.$3(typeName);if($0.IsCustomEntity!=null&&!!$0.IsCustomEntity){if($0.IconSmallName!=null){return '../../'+$0.IconSmallName;}else{return '../../../../_Common/icon.aspx?cache=1&iconType=NavigationIcon&objectTypeCode='+$0.ObjectTypeCode.toString();}}else{return '/_imgs/ico_16_'+$0.ObjectTypeCode.toString()+'.gif';}}
SparkleXrm.Sdk.Metadata.MetadataCache.$3=function($p0){var $0=$p0;var $1=SparkleXrm.Sdk.Metadata.MetadataCache.$1[$0];if($1==null){var $2=new SparkleXrm.Sdk.Messages.RetrieveEntityRequest();$2.EntityFilters=1;$2.LogicalName=$p0;$2.RetrieveAsIfPublished=true;$2.MetadataId=new SparkleXrm.Sdk.Guid('00000000-0000-0000-0000-000000000000');var $3=SparkleXrm.Sdk.OrganizationServiceProxy.execute($2);$1=$3.EntityMetadata;SparkleXrm.Sdk.Metadata.MetadataCache.$1[$0]=$1;}return $1;}
SparkleXrm.Sdk.Metadata.MetadataCache.$4=function($p0,$p1){var $0=$p0+'|'+$p1;var $1=SparkleXrm.Sdk.Metadata.MetadataCache.$0[$0];if($1==null){var $2=new SparkleXrm.Sdk.Messages.RetrieveAttributeRequest();$2.EntityLogicalName=$p0;$2.LogicalName=$p1;$2.RetrieveAsIfPublished=true;var $3=SparkleXrm.Sdk.OrganizationServiceProxy.execute($2);$1=$3.AttributeMetadata;SparkleXrm.Sdk.Metadata.MetadataCache.$0[$0]=$1;}return $1;}
SparkleXrm.Sdk.Metadata.MetadataCache.AddOptionsetMetadata=function(entityLogicalName,attributeLogicalName,allowEmpty,metatdata){var $0=entityLogicalName+'.'+attributeLogicalName+'.'+allowEmpty.toString();var $1=[];if(allowEmpty){$1.add({});}var $enum1=ss.IEnumerator.getEnumerator(metatdata);while($enum1.moveNext()){var $2=$enum1.current;var $3={};$3.name=$2['label'];$3.value=$2['value'];$1.add($3);}SparkleXrm.Sdk.Metadata.MetadataCache.get_optionsetMetaData()[$0]=$1;}
SparkleXrm.Sdk.Metadata.Query.MetadataConditionOperator=function(){};SparkleXrm.Sdk.Metadata.Query.MetadataConditionOperator.prototype = {Equals:'Equals',NotEquals:'NotEquals',In:'In',NotIn:'NotIn',GreaterThan:'GreaterThan',LessThan:'LessThan'}
SparkleXrm.Sdk.Metadata.Query.MetadataConditionOperator.registerEnum('SparkleXrm.Sdk.Metadata.Query.MetadataConditionOperator',false);SparkleXrm.Sdk.Metadata.Query.LogicalOperator=function(){};SparkleXrm.Sdk.Metadata.Query.LogicalOperator.prototype = {And:'And',Or:'Or'}
SparkleXrm.Sdk.Metadata.Query.LogicalOperator.registerEnum('SparkleXrm.Sdk.Metadata.Query.LogicalOperator',false);SparkleXrm.Sdk.Metadata.Query.MetadataQueryBuilder=function(){this.request=new SparkleXrm.Sdk.Messages.RetrieveMetadataChangesRequest();this.request.query={};this.request.query.Criteria={};this.request.query.Criteria.FilterOperator='Or';this.request.query.Criteria.Conditions=[];}
SparkleXrm.Sdk.Metadata.Query.MetadataQueryBuilder.prototype={request:null,addEntities:function(entityLogicalNames,propertiesToReturn){this.request.query.Criteria={};this.request.query.Criteria.FilterOperator='Or';this.request.query.Criteria.Conditions=[];var $enum1=ss.IEnumerator.getEnumerator(entityLogicalNames);while($enum1.moveNext()){var $0=$enum1.current;var $1={};$1.ConditionOperator='Equals';$1.PropertyName='LogicalName';$1.Value=$0;this.request.query.Criteria.Conditions.add($1);}this.request.query.Properties={};this.request.query.Properties.PropertyNames=propertiesToReturn;},addAttributes:function(attributeLogicalNames,propertiesToReturn){var $0={};$0.Properties={};$0.Properties.PropertyNames=propertiesToReturn;this.request.query.AttributeQuery=$0;var $1={};$0.Criteria=$1;$1.FilterOperator='Or';$1.Conditions=[];var $enum1=ss.IEnumerator.getEnumerator(attributeLogicalNames);while($enum1.moveNext()){var $2=$enum1.current;var $3={};$3.PropertyName='LogicalName';$3.ConditionOperator='Equals';$3.Value=$2;$1.Conditions.add($3);}},setLanguage:function(lcid){this.request.query.LabelQuery={};this.request.query.LabelQuery.FilterLanguages=[];this.request.query.LabelQuery.FilterLanguages.add(lcid);}}
Type.registerNamespace('SparkleXrm.Sdk.Ribbon');SparkleXrm.Sdk.Ribbon.RibbonButton=function(Id,Sequence,LabelText,Command,Image16,Image32){SparkleXrm.Sdk.Ribbon.RibbonButton.initializeBase(this,[Id,Sequence,LabelText,Command,Image16,Image32]);}
SparkleXrm.Sdk.Ribbon.RibbonButton.prototype={serialiseToRibbonXml:function(sb){sb.appendLine('<Button Id="'+SparkleXrm.Sdk.XmlHelper.encode(this.Id)+'" LabelText="'+SparkleXrm.Sdk.XmlHelper.encode(this.LabelText)+'" Sequence="'+this.Sequence.toString()+'" Command="'+SparkleXrm.Sdk.XmlHelper.encode(this.Command)+'"'+((this.Image32by32!=null)?(' Image32by32="'+SparkleXrm.Sdk.XmlHelper.encode(this.Image32by32)+'"'):'')+((this.Image16by16!=null)?(' Image16by16="'+SparkleXrm.Sdk.XmlHelper.encode(this.Image16by16)+'"'):'')+' />');}}
SparkleXrm.Sdk.Ribbon.RibbonControl=function(Id,Sequence,LabelText,Command,Image16,Image32){this.Id=Id;this.Sequence=Sequence;this.LabelText=LabelText;this.Command=Command;this.Image16by16=Image16;this.Image32by32=Image32;}
SparkleXrm.Sdk.Ribbon.RibbonControl.prototype={Id:null,LabelText:null,Sequence:0,Command:null,Image16by16:null,Image32by32:null,serialiseToRibbonXml:function(sb){}}
SparkleXrm.Sdk.Ribbon.RibbonFlyoutAnchor=function(Id,Sequence,LabelText,Command,Image16,Image32){SparkleXrm.Sdk.Ribbon.RibbonFlyoutAnchor.initializeBase(this,[Id,Sequence,LabelText,Command,Image16,Image32]);}
SparkleXrm.Sdk.Ribbon.RibbonFlyoutAnchor.prototype={menu:null,serialiseToRibbonXml:function(sb){sb.appendLine('<FlyoutAnchor Id="'+SparkleXrm.Sdk.XmlHelper.encode(this.Id)+'" LabelText="'+SparkleXrm.Sdk.XmlHelper.encode(this.LabelText)+'" Sequence="'+this.Sequence.toString()+'" Command="'+SparkleXrm.Sdk.XmlHelper.encode(this.Command)+'"'+((this.Image32by32!=null)?(' Image32by32="'+SparkleXrm.Sdk.XmlHelper.encode(this.Image32by32)+'"'):'')+((this.Image16by16!=null)?(' Image16by16="'+SparkleXrm.Sdk.XmlHelper.encode(this.Image16by16)+'"'):'')+' PopulateDynamically="false">');sb.appendLine(this.menu.serialiseToRibbonXml());sb.appendLine('</FlyoutAnchor>');}}
SparkleXrm.Sdk.Ribbon.RibbonMenu=function(Id){this.sections=[];this.Id=Id;}
SparkleXrm.Sdk.Ribbon.RibbonMenu.prototype={Id:null,serialiseToRibbonXml:function(){var $0=new ss.StringBuilder();$0.appendLine('<Menu Id="'+this.Id+'">');var $enum1=ss.IEnumerator.getEnumerator(this.sections);while($enum1.moveNext()){var $1=$enum1.current;$1.serialiseToRibbonXml($0);}$0.appendLine('</Menu>');return $0.toString();},addSection:function(section){SparkleXrm.ArrayEx.add(this.sections,section);return this;}}
SparkleXrm.Sdk.Ribbon.RibbonMenuSection=function(Id,LabelText,Sequence,DisplayMode){this.buttons=[];this.Id=Id;this.Title=LabelText;this.Sequence=Sequence;this.DisplayMode=DisplayMode;}
SparkleXrm.Sdk.Ribbon.RibbonMenuSection.prototype={Id:null,Title:null,Sequence:0,DisplayMode:null,serialiseToRibbonXml:function(sb){sb.appendLine('<MenuSection Id="'+SparkleXrm.Sdk.XmlHelper.encode(this.Id)+((this.Title!=null)?'" Title="'+this.Title:'')+'" Sequence="'+this.Sequence.toString()+'" DisplayMode="'+this.DisplayMode+'">');sb.appendLine('<Controls Id="'+SparkleXrm.Sdk.XmlHelper.encode(this.Id+'.Controls')+'">');var $enum1=ss.IEnumerator.getEnumerator(this.buttons);while($enum1.moveNext()){var $0=$enum1.current;$0.serialiseToRibbonXml(sb);}sb.appendLine('</Controls>');sb.appendLine('</MenuSection>');},addButton:function(button){SparkleXrm.ArrayEx.add(this.buttons,button);return this;}}
Type.registerNamespace('SparkleXrm.Services');SparkleXrm.Services.CachedOrganizationService=function(){}
SparkleXrm.Services.CachedOrganizationService.retrieve=function(entityName,entityId,attributesList){var $0=SparkleXrm.Services.CachedOrganizationService.cache.get(entityName,entityId);if($0==null){$0=SparkleXrm.Sdk.OrganizationServiceProxy.retrieve(entityName,entityId,attributesList);SparkleXrm.Services.CachedOrganizationService.cache.insert(entityName,entityId,$0);return $0;}else{return $0;}}
SparkleXrm.Services.CachedOrganizationService.retrieveMultiple=function(fetchXml){var $0=SparkleXrm.Services.CachedOrganizationService.cache.get('query',fetchXml);if($0==null){$0=SparkleXrm.Sdk.OrganizationServiceProxy.retrieveMultiple(fetchXml);SparkleXrm.Services.CachedOrganizationService.cache.insert('query',fetchXml,$0);return $0;}else{return $0;}}
SparkleXrm.Services.OrganizationServiceCache=function(){this.$0={};}
SparkleXrm.Services.OrganizationServiceCache.prototype={remove:function(entityName,id){},insert:function(key,query,results){this.$0[key+'_'+query]=results;},get:function(key,query){return this.$0[key+'_'+query];}}
SparkleXrm.ArrayEx.registerClass('SparkleXrm.ArrayEx');SparkleXrm.DelegateItterator.registerClass('SparkleXrm.DelegateItterator');SparkleXrm.NumberEx.registerClass('SparkleXrm.NumberEx');SparkleXrm.Xrm.PageEx.registerClass('SparkleXrm.Xrm.PageEx');SparkleXrm.StringEx.registerClass('SparkleXrm.StringEx');SparkleXrm.TaskIterrator.registerClass('SparkleXrm.TaskIterrator');SparkleXrm.Sdk.ColumnSet.registerClass('SparkleXrm.Sdk.ColumnSet');SparkleXrm.Sdk.Attribute.registerClass('SparkleXrm.Sdk.Attribute');SparkleXrm.Sdk.AttributeTypes.registerClass('SparkleXrm.Sdk.AttributeTypes');SparkleXrm.Sdk.Entity.registerClass('SparkleXrm.Sdk.Entity',null,SparkleXrm.ComponentModel.INotifyPropertyChanged);SparkleXrm.Sdk.OrganizationSettings.registerClass('SparkleXrm.Sdk.OrganizationSettings',SparkleXrm.Sdk.Entity);SparkleXrm.Sdk.UserSettingsAttributes.registerClass('SparkleXrm.Sdk.UserSettingsAttributes');SparkleXrm.Sdk.UserSettings.registerClass('SparkleXrm.Sdk.UserSettings',SparkleXrm.Sdk.Entity);SparkleXrm.Sdk.DataCollectionOfEntity.registerClass('SparkleXrm.Sdk.DataCollectionOfEntity',null,ss.IEnumerable);SparkleXrm.Sdk.DateTimeEx.registerClass('SparkleXrm.Sdk.DateTimeEx');SparkleXrm.Sdk.EntityCollection.registerClass('SparkleXrm.Sdk.EntityCollection');SparkleXrm.Sdk.EntityReference.registerClass('SparkleXrm.Sdk.EntityReference');SparkleXrm.Sdk.Guid.registerClass('SparkleXrm.Sdk.Guid');SparkleXrm.Sdk.Money.registerClass('SparkleXrm.Sdk.Money');SparkleXrm.Sdk.OptionSetValue.registerClass('SparkleXrm.Sdk.OptionSetValue');Xrm.Sdk.OrganisationServiceMetadata.registerClass('Xrm.Sdk.OrganisationServiceMetadata');SparkleXrm.Sdk.OrganizationServiceProxy.registerClass('SparkleXrm.Sdk.OrganizationServiceProxy');SparkleXrm.Sdk.XrmService.registerClass('SparkleXrm.Sdk.XrmService');SparkleXrm.Sdk.Relationship.registerClass('SparkleXrm.Sdk.Relationship');SparkleXrm.Sdk.RetrieveRelationshipRequest.registerClass('SparkleXrm.Sdk.RetrieveRelationshipRequest',null,Object,Object);SparkleXrm.Sdk.RetrieveRelationshipResponse.registerClass('SparkleXrm.Sdk.RetrieveRelationshipResponse',null,Object);SparkleXrm.Sdk.WebApiRequestResponse.registerClass('SparkleXrm.Sdk.WebApiRequestResponse');SparkleXrm.Sdk.WebApiOrganizationServiceProxy.registerClass('SparkleXrm.Sdk.WebApiOrganizationServiceProxy',null,SparkleXrm.Sdk.IOrganizationService);SparkleXrm.Sdk.XmlHelper.registerClass('SparkleXrm.Sdk.XmlHelper');SparkleXrm.Sdk.Messages.AddToQueueRequest.registerClass('SparkleXrm.Sdk.Messages.AddToQueueRequest',null,Object,Object);SparkleXrm.Sdk.Messages.AddToQueueResponse.registerClass('SparkleXrm.Sdk.Messages.AddToQueueResponse',null,Object);SparkleXrm.Sdk.Messages.AssignRequest.registerClass('SparkleXrm.Sdk.Messages.AssignRequest',null,Object);SparkleXrm.Sdk.Messages.AssignResponse.registerClass('SparkleXrm.Sdk.Messages.AssignResponse',null,Object);SparkleXrm.Sdk.Messages.BulkDeleteRequest.registerClass('SparkleXrm.Sdk.Messages.BulkDeleteRequest',null,Object);SparkleXrm.Sdk.Messages.BulkDeleteResponse.registerClass('SparkleXrm.Sdk.Messages.BulkDeleteResponse',null,Object);SparkleXrm.Sdk.Messages.ExecuteWorkflowRequest.registerClass('SparkleXrm.Sdk.Messages.ExecuteWorkflowRequest',null,Object);SparkleXrm.Sdk.Messages.ExecuteWorkflowResponse.registerClass('SparkleXrm.Sdk.Messages.ExecuteWorkflowResponse',null,Object);SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionRequest.registerClass('SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionRequest',null,Object);SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionResponse.registerClass('SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionResponse',null,Object);SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties.registerClass('SparkleXrm.Sdk.Messages.WebAPIOrgnanizationRequestProperties');SparkleXrm.Sdk.Messages.RetrieveAllEntitiesRequest.registerClass('SparkleXrm.Sdk.Messages.RetrieveAllEntitiesRequest',null,Object);SparkleXrm.Sdk.Messages.RetrieveAllEntitiesResponse.registerClass('SparkleXrm.Sdk.Messages.RetrieveAllEntitiesResponse',null,Object);SparkleXrm.Sdk.Messages.RetrieveAttributeRequest.registerClass('SparkleXrm.Sdk.Messages.RetrieveAttributeRequest',null,Object,Object);SparkleXrm.Sdk.Messages.RetrieveAttributeResponse.registerClass('SparkleXrm.Sdk.Messages.RetrieveAttributeResponse',null,Object);Xrm.Sdk.Messages.RetrieveDuplicatesRequest.registerClass('Xrm.Sdk.Messages.RetrieveDuplicatesRequest',null,Object,Object);Xrm.Sdk.Messages.RetrieveDuplicatesResponse.registerClass('Xrm.Sdk.Messages.RetrieveDuplicatesResponse',null,Object,Object);SparkleXrm.Sdk.Messages.RetrieveEntityRequest.registerClass('SparkleXrm.Sdk.Messages.RetrieveEntityRequest',null,Object,Object);SparkleXrm.Sdk.Messages.RetrieveEntityResponse.registerClass('SparkleXrm.Sdk.Messages.RetrieveEntityResponse',null,Object);SparkleXrm.Sdk.Messages.RetrieveMetadataChangesRequest.registerClass('SparkleXrm.Sdk.Messages.RetrieveMetadataChangesRequest',null,Object,Object);SparkleXrm.Sdk.Messages.RetrieveMetadataChangesResponse.registerClass('SparkleXrm.Sdk.Messages.RetrieveMetadataChangesResponse',null,Object,Object);SparkleXrm.Sdk.Messages.RetrieveUserPrivilegesRequest.registerClass('SparkleXrm.Sdk.Messages.RetrieveUserPrivilegesRequest',null,Object,Object);Xrm.Sdk.Messages.RolePrivilege.registerClass('Xrm.Sdk.Messages.RolePrivilege');SparkleXrm.Sdk.Messages.RetrieveUserPrivilegesResponse.registerClass('SparkleXrm.Sdk.Messages.RetrieveUserPrivilegesResponse',null,Object,Object);SparkleXrm.Sdk.Messages.WhoAmIRequest.registerClass('SparkleXrm.Sdk.Messages.WhoAmIRequest',null,Object,Object);SparkleXrm.Sdk.Messages.WhoAmIResponse.registerClass('SparkleXrm.Sdk.Messages.WhoAmIResponse',null,Object,Object);SparkleXrm.Sdk.Messages.WinOpportunityRequest.registerClass('SparkleXrm.Sdk.Messages.WinOpportunityRequest',null,Object,Object);SparkleXrm.Sdk.Messages.WinOpportunityResponse.registerClass('SparkleXrm.Sdk.Messages.WinOpportunityResponse',null,Object);SparkleXrm.Sdk.Messages.PagingInfo.registerClass('SparkleXrm.Sdk.Messages.PagingInfo');SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.registerClass('SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser');SparkleXrm.Sdk.Metadata.MetadataCache.registerClass('SparkleXrm.Sdk.Metadata.MetadataCache');SparkleXrm.Sdk.Metadata.Query.MetadataQueryBuilder.registerClass('SparkleXrm.Sdk.Metadata.Query.MetadataQueryBuilder');SparkleXrm.Sdk.Ribbon.RibbonControl.registerClass('SparkleXrm.Sdk.Ribbon.RibbonControl');SparkleXrm.Sdk.Ribbon.RibbonButton.registerClass('SparkleXrm.Sdk.Ribbon.RibbonButton',SparkleXrm.Sdk.Ribbon.RibbonControl);SparkleXrm.Sdk.Ribbon.RibbonFlyoutAnchor.registerClass('SparkleXrm.Sdk.Ribbon.RibbonFlyoutAnchor',SparkleXrm.Sdk.Ribbon.RibbonControl);SparkleXrm.Sdk.Ribbon.RibbonMenu.registerClass('SparkleXrm.Sdk.Ribbon.RibbonMenu');SparkleXrm.Sdk.Ribbon.RibbonMenuSection.registerClass('SparkleXrm.Sdk.Ribbon.RibbonMenuSection');SparkleXrm.Services.CachedOrganizationService.registerClass('SparkleXrm.Services.CachedOrganizationService');SparkleXrm.Services.OrganizationServiceCache.registerClass('SparkleXrm.Services.OrganizationServiceCache');SparkleXrm.Xrm.PageEx.majorVersion=0;(function(){SparkleXrm.Xrm.PageEx.majorVersion=2011;if(typeof(window.APPLICATION_VERSION)!=='undefined'){var $0=window.APPLICATION_VERSION;if($0!=='5.0'){SparkleXrm.Xrm.PageEx.majorVersion=2013;}}})();
SparkleXrm.Sdk.AttributeTypes.string_='string';SparkleXrm.Sdk.AttributeTypes.decimal_='decimal';SparkleXrm.Sdk.AttributeTypes.int_='int';SparkleXrm.Sdk.AttributeTypes.double_='double';SparkleXrm.Sdk.AttributeTypes.dateTime_='dateTime';SparkleXrm.Sdk.AttributeTypes.boolean_='boolean';SparkleXrm.Sdk.AttributeTypes.entityReference='EntityReference';SparkleXrm.Sdk.AttributeTypes.guid_='guid';SparkleXrm.Sdk.AttributeTypes.optionSetValue='OptionSetValue';SparkleXrm.Sdk.AttributeTypes.aliasedValue='AliasedValue';SparkleXrm.Sdk.AttributeTypes.entityCollection='EntityCollection';SparkleXrm.Sdk.AttributeTypes.money='Money';SparkleXrm.Sdk.OrganizationSettings.entityLogicalName='organization';SparkleXrm.Sdk.UserSettingsAttributes.userSettingsId='usersettingsid';SparkleXrm.Sdk.UserSettingsAttributes.businessUnitId='businessunitid';SparkleXrm.Sdk.UserSettingsAttributes.calendarType='calendartype';SparkleXrm.Sdk.UserSettingsAttributes.currencyDecimalPrecision='currencydecimalprecision';SparkleXrm.Sdk.UserSettingsAttributes.currencyFormatCode='currencyformatcode';SparkleXrm.Sdk.UserSettingsAttributes.currencySymbol='currencysymbol';SparkleXrm.Sdk.UserSettingsAttributes.dateFormatCode='dateformatcode';SparkleXrm.Sdk.UserSettingsAttributes.dateFormatString='dateformatstring';SparkleXrm.Sdk.UserSettingsAttributes.dateSeparator='dateseparator';SparkleXrm.Sdk.UserSettingsAttributes.decimalSymbol='decimalsymbol';SparkleXrm.Sdk.UserSettingsAttributes.defaultCalendarView='defaultcalendarview';SparkleXrm.Sdk.UserSettingsAttributes.defaultDashboardId='defaultdashboardid';SparkleXrm.Sdk.UserSettingsAttributes.localeId='localeid';SparkleXrm.Sdk.UserSettingsAttributes.longDateFormatCode='longdateformatcode';SparkleXrm.Sdk.UserSettingsAttributes.negativeCurrencyFormatCode='negativecurrencyformatcode';SparkleXrm.Sdk.UserSettingsAttributes.negativeFormatCode='negativeformatcode';SparkleXrm.Sdk.UserSettingsAttributes.numberGroupFormat='numbergroupformat';SparkleXrm.Sdk.UserSettingsAttributes.numberSeparator='numberseparator';SparkleXrm.Sdk.UserSettingsAttributes.offlineSyncInterval='offlinesyncinterval';SparkleXrm.Sdk.UserSettingsAttributes.pricingDecimalPrecision='pricingdecimalprecision';SparkleXrm.Sdk.UserSettingsAttributes.showWeekNumber='showweeknumber';SparkleXrm.Sdk.UserSettingsAttributes.systemUserId='systemuserid';SparkleXrm.Sdk.UserSettingsAttributes.timeFormatCodestring='timeformatcodestring';SparkleXrm.Sdk.UserSettingsAttributes.timeFormatString='timeformatstring';SparkleXrm.Sdk.UserSettingsAttributes.timeSeparator='timeseparator';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneBias='timezonebias';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneCode='timezonecode';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightBias='timezonedaylightbias';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightDay='timezonedaylightday';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightDayOfWeek='timezonedaylightdayofweek';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightHour='timezonedaylighthour';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightMinute='timezonedaylightminute';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightMonth='timezonedaylightmonth';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightSecond='timezonedaylightsecond';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightYear='timezonedaylightyear';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardBias='timezonestandardbias';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardDay='timezonestandardday';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardDayOfWeek='timezonestandarddayofweek';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardHour='timezonestandardhour';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardMinute='timezonestandardminute';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardMonth='timezonestandardmonth';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardSecond='timezonestandardsecond';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardYear='timezonestandardyear';SparkleXrm.Sdk.UserSettingsAttributes.transactionCurrencyId='transactioncurrencyid';SparkleXrm.Sdk.UserSettingsAttributes.uiLanguageId='uilanguageid';SparkleXrm.Sdk.UserSettingsAttributes.workdayStartTime='workdaystarttime';SparkleXrm.Sdk.UserSettingsAttributes.workdayStopTime='workdaystoptime';SparkleXrm.Sdk.UserSettings.entityLogicalName='usersettings';SparkleXrm.Sdk.Guid.empty=new SparkleXrm.Sdk.Guid('00000000-0000-0000-0000-000000000000');Xrm.Sdk.OrganisationServiceMetadata.executeMessageResponseTypes={};(function(){Xrm.Sdk.OrganisationServiceMetadata.registerExecuteMessageResponseType('RetrieveAttribute',SparkleXrm.Sdk.Messages.RetrieveAttributeResponse);Xrm.Sdk.OrganisationServiceMetadata.registerExecuteMessageResponseType('RetrieveAllEntities',SparkleXrm.Sdk.Messages.RetrieveAllEntitiesResponse);Xrm.Sdk.OrganisationServiceMetadata.registerExecuteMessageResponseType('RetrieveEntity',SparkleXrm.Sdk.Messages.RetrieveEntityResponse);Xrm.Sdk.OrganisationServiceMetadata.registerExecuteMessageResponseType('BulkDeleteResponse',SparkleXrm.Sdk.Messages.BulkDeleteResponse);Xrm.Sdk.OrganisationServiceMetadata.registerExecuteMessageResponseType('FetchXmlToQueryExpression',SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionResponse);Xrm.Sdk.OrganisationServiceMetadata.registerExecuteMessageResponseType('RetrieveMetadataChanges',SparkleXrm.Sdk.Messages.RetrieveMetadataChangesResponse);Xrm.Sdk.OrganisationServiceMetadata.registerExecuteMessageResponseType('RetrieveRelationship',SparkleXrm.Sdk.RetrieveRelationshipResponse);Xrm.Sdk.OrganisationServiceMetadata.registerExecuteMessageResponseType('ExecuteWorkflow',SparkleXrm.Sdk.Messages.ExecuteWorkflowResponse);Xrm.Sdk.OrganisationServiceMetadata.registerExecuteMessageResponseType('Assign',SparkleXrm.Sdk.Messages.AssignResponse);})();
SparkleXrm.Sdk.OrganizationServiceProxy.userSettings=null;SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings=null;SparkleXrm.Sdk.OrganizationServiceProxy.$0=null;(function(){SparkleXrm.Sdk.OrganizationServiceProxy.$0=new SparkleXrm.Sdk.WebApiOrganizationServiceProxy();})();
SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$0=null;SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$1='8.2';SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$2=['bcc','cc','customers','from','optionalattendees','organizer','partners','requiredattendees','resources','to'];SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$3={};SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$4={};SparkleXrm.Sdk.WebApiOrganizationServiceProxy.$5={};(function(){SparkleXrm.Sdk.WebApiOrganizationServiceProxy.addMetadata('contact','contacts','contactid');SparkleXrm.Sdk.WebApiOrganizationServiceProxy.addMetadata('account','accounts','accountid');SparkleXrm.Sdk.WebApiOrganizationServiceProxy.addMetadata('systemuser','systemusers','systemuserid');SparkleXrm.Sdk.WebApiOrganizationServiceProxy.addMetadata('activityparty','activityparties','activitypartyid');})();
SparkleXrm.Sdk.XmlHelper._encode_map={'&':'&amp;','"':'&quot;','<':'&lt;','>':'&gt;',"'":'&#39;'};SparkleXrm.Sdk.XmlHelper._decode_map={'&amp;':'&','&quot;':'"','&lt;':'<','&gt;':'>','&#39;':"'"};SparkleXrm.Sdk.Metadata.MetadataCache.$0={};SparkleXrm.Sdk.Metadata.MetadataCache.$1={};SparkleXrm.Sdk.Metadata.MetadataCache.$2={};SparkleXrm.Services.CachedOrganizationService.cache=new SparkleXrm.Services.OrganizationServiceCache();});